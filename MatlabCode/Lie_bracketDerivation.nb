(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    160811,       4314]
NotebookOptionsPosition[    158317,       4274]
NotebookOutlinePosition[    158675,       4289]
CellTagsIndexPosition[    158632,       4286]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Use", " ", "'"}], "//", 
    RowBox[{
     RowBox[{"TeXForm", "'"}], " ", "to", " ", "print", " ", "latex", " ", 
     "code", " ", "for", " ", "the", " ", "equation"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LieBracket", "[", 
     RowBox[{"f_", ",", "g_", ",", "x_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"g", ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], ".", "f"}], " ", "-", "  ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"f", ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], ".", "g"}]}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", "x3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"a2", " ", "-", " ", "a3"}], "a1"], "x2", "*", "x3"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"a3", " ", "-", " ", "a1"}], "a2"], "x1", "*", "x3"}], ",", 
     RowBox[{
      FractionBox[
       RowBox[{"a1", " ", "-", " ", "a2"}], "a3"], "x2", "*", "x1"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g1", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{
   RowBox[{"g2", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g3", " ", "=", " ", 
   RowBox[{"LieBracket", "[", 
    RowBox[{"f", ",", "g1", ",", "X"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"g3", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g4", " ", "=", " ", 
   RowBox[{"LieBracket", "[", 
    RowBox[{"f", ",", "g2", ",", "X"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"g4", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g5", " ", "=", " ", 
   RowBox[{"LieBracket", "[", 
    RowBox[{"g1", ",", "g2", ",", "X"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"g5", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g6", " ", "=", " ", 
   RowBox[{"LieBracket", "[", 
    RowBox[{"g1", ",", "g4", ",", "X"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"g6", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.778858014656802*^9, 3.7788580377059183`*^9}, {
   3.778858089363957*^9, 3.77885815887394*^9}, {3.778858381140093*^9, 
   3.77885838881098*^9}, {3.778858683813115*^9, 3.778858692618531*^9}, {
   3.778858723453637*^9, 3.7788587254211893`*^9}, {3.778859064302055*^9, 
   3.77885907056363*^9}, {3.778859147385119*^9, 3.7788592678569803`*^9}, {
   3.778859302990919*^9, 3.7788594318823423`*^9}, {3.77885959727512*^9, 
   3.778859610538253*^9}, {3.778860247349059*^9, 3.778860274538127*^9}, {
   3.778860326788534*^9, 3.778860334575008*^9}, {3.778860433043626*^9, 
   3.77886043321026*^9}, {3.7788605390047293`*^9, 3.778860555747097*^9}, {
   3.778860912756343*^9, 3.7788609168742647`*^9}, 3.77886104172223*^9, {
   3.7788611033327093`*^9, 3.7788611325792637`*^9}, {3.778861215554771*^9, 
   3.77886125345966*^9}, {3.778861315603407*^9, 3.7788613200752974`*^9}, {
   3.778861432036343*^9, 3.778861435730754*^9}, {3.7788614692692137`*^9, 
   3.77886167768999*^9}, {3.7788618359663277`*^9, 3.778861990859186*^9}, {
   3.778862462814994*^9, 3.778862482490921*^9}, {3.778862745189069*^9, 
   3.778862765130561*^9}, {3.778862986467956*^9, 3.7788630052865667`*^9}, {
   3.778867719733214*^9, 3.778867720306025*^9}, {3.7788678521009693`*^9, 
   3.778867951203915*^9}, {3.778867985084324*^9, 3.778868094442308*^9}, {
   3.778868125615527*^9, 3.778868138946154*^9}, {3.778868969146483*^9, 
   3.778869023177984*^9}, {3.7788690649675293`*^9, 3.778869170194291*^9}, {
   3.778869285272143*^9, 3.7788693124423437`*^9}, {3.778869367132259*^9, 
   3.778869521986577*^9}, {3.778869596717614*^9, 3.778869601890716*^9}, {
   3.778869711427286*^9, 3.778869796859796*^9}, {3.7788698305593224`*^9, 
   3.778870012290617*^9}, {3.77887005692631*^9, 3.778870061284816*^9}, {
   3.778870193965193*^9, 3.778870286554305*^9}, {3.7788704461804247`*^9, 
   3.778870459212894*^9}, {3.778870722036295*^9, 3.778870804705299*^9}, {
   3.77887083741991*^9, 3.778870928244409*^9}, {3.7788710133958263`*^9, 
   3.778871017364955*^9}, 3.778871132283616*^9, {3.7788715540183687`*^9, 
   3.778871620447536*^9}, {3.778871654643371*^9, 3.778871801381507*^9}, {
   3.778872015110952*^9, 3.7788720316031933`*^9}, {3.7788720631330013`*^9, 
   3.7788720753629417`*^9}, {3.7788729589691896`*^9, 
   3.7788729800982723`*^9}, {3.7788730916028643`*^9, 3.778873094964471*^9}, {
   3.778873275763835*^9, 3.7788733598502617`*^9}, 3.778873411854135*^9, 
   3.778873639279334*^9, 3.778873701430077*^9, {3.778873775564468*^9, 
   3.778873952442108*^9}, {3.778874578528903*^9, 3.778874618441931*^9}, {
   3.778875298854278*^9, 3.778875321442235*^9}, {3.778875356766789*^9, 
   3.7788754713963947`*^9}, {3.7788755163585873`*^9, 3.778875684970623*^9}, {
   3.77887572078813*^9, 3.7788757855146027`*^9}, {3.77887581779773*^9, 
   3.778875838506701*^9}, {3.778875869772182*^9, 3.7788758708421783`*^9}, {
   3.778875949021611*^9, 3.778875949330677*^9}, {3.778875982989743*^9, 
   3.778876031882321*^9}, {3.778876100565166*^9, 3.7788761321702423`*^9}, {
   3.778876254484424*^9, 3.778876315653782*^9}, {3.778884856134207*^9, 
   3.7788848685804768`*^9}, {3.795101956006228*^9, 3.7951019567865458`*^9}, {
   3.795101998108461*^9, 3.7951019992095346`*^9}, {3.797002812128903*^9, 
   3.797002812871435*^9}},ExpressionUUID->"53b5a660-d093-4e31-ad2e-\
7e17080d0ab1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Use", " ", "'"}], "//", 
    RowBox[{
     RowBox[{"TeXForm", "'"}], " ", "to", " ", "print", " ", "latex", " ", 
     "code", " ", "for", " ", "the", " ", "equation"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LieBracket", "[", 
     RowBox[{"f_", ",", "g_", ",", "x_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"g", ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], ".", "f"}], " ", "-", "  ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"f", ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], ".", "g"}]}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"InertiaMatrix", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i11", ",", " ", "i12", ",", " ", "i13"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i21", ",", " ", "i22", ",", " ", "i23"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i31", ",", " ", "i32", ",", " ", "i33"}], "}"}]}], "}"}]}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InertiaMatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "i2", ",", " ", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "i3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Omegatilde", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"-", "\[Omega]3"}], ",", " ", "\[Omega]2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]3", ",", "0", ",", 
       RowBox[{"-", "\[Omega]1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "\[Omega]2"}], ",", "\[Omega]1", ",", "0"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bmatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"-", "\[Omega]1"}], ",", " ", 
       RowBox[{"-", "\[Omega]2"}], ",", " ", 
       RowBox[{"-", "\[Omega]3"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]1", ",", " ", "0", ",", " ", "\[Omega]3", ",", " ", 
       RowBox[{"-", "\[Omega]2"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]2", ",", " ", 
       RowBox[{"-", "\[Omega]3"}], ",", " ", "0", ",", " ", "\[Omega]1"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]3", ",", "\[Omega]2", ",", " ", 
       RowBox[{"-", "\[Omega]1"}], ",", " ", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OmegaVector", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Omega]1", ",", " ", "\[Omega]2", ",", " ", "\[Omega]3"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BetaVector", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"\[Beta]0", ",", "\[Beta]1", ",", "\[Beta]2", ",", "\[Beta]3"}], 
     "}"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"BetaVector", ",", "OmegaVector"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f0", " ", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], 
      RowBox[{"Bmatrix", ".", "BetaVector"}]}], ",", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Inverse", "[", "InertiaMatrix", "]"}], ".", "Omegatilde", ".",
        "InertiaMatrix", ".", "OmegaVector"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g1", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Inverse", "[", "InertiaMatrix", "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g2", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Inverse", "[", "InertiaMatrix", "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g3", " ", "=", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Inverse", "[", "InertiaMatrix", "]"}], ".", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g4", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f0", ",", "g1", ",", "X"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"[", 
     RowBox[{
      SubscriptBox["f", "0"], ",", 
      SubscriptBox["g", "1"]}], "]"}], " ", "\[Rule]", " ", 
    RowBox[{"good", " ", "lie", " ", "product"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g5", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f0", ",", "g2", ",", "X"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"[", 
     RowBox[{
      SubscriptBox["f", "0"], ",", 
      SubscriptBox["g", "1"]}], "]"}], " ", "\[Rule]", " ", 
    RowBox[{"good", " ", "lie", " ", "product"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g6", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f0", ",", "g3", ",", "X"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"[", 
     RowBox[{
      SubscriptBox["f", "0"], ",", 
      SubscriptBox["g", "1"]}], "]"}], " ", "\[Rule]", " ", 
    RowBox[{"good", " ", "lie", " ", "product"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalDelta]", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           SubscriptBox["f", "0"], "}"}], ",", 
          RowBox[{"{", 
           SubscriptBox["g", "1"], "}"}]}], "}"}], "]"}], " ", "//", 
       "FullSimplify"}], "//", "MatrixForm"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Dimensions", "[", 
    SubscriptBox["g", "1"], "]"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g7", " ", "=", " ", 
   RowBox[{"LieBracket", "[", 
    RowBox[{"g3", ",", "g4", ",", "X"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"X", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f0", " ", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalDelta]", " ", "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
       "f0", ",", "g1", ",", "g2", ",", "g3", ",", "g4", ",", "g5", ",", 
        "g6"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Det", "[", "\[CapitalDelta]", "]"}], "//", "Simplify"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.778884405279975*^9, 3.778884848653569*^9, {3.7788848846827717`*^9, 
   3.77888490131549*^9}, {3.778885012541892*^9, 3.778885235301783*^9}, {
   3.778885296852869*^9, 3.778885668042337*^9}, {3.7788857268970413`*^9, 
   3.778885845336267*^9}, {3.7788858854902287`*^9, 3.778885893724629*^9}, {
   3.778885999593359*^9, 3.778886025719557*^9}, {3.778886095816341*^9, 
   3.7788860959431067`*^9}, {3.778886143744171*^9, 3.778886201255641*^9}, {
   3.778886247993565*^9, 3.7788864715797663`*^9}, {3.778886584101925*^9, 
   3.778886712469483*^9}, {3.7788867465699377`*^9, 3.778886752328376*^9}, {
   3.778887721683691*^9, 3.77888774939089*^9}, {3.7788877915286703`*^9, 
   3.778887999949224*^9}, {3.7788880575477*^9, 3.7788880710684967`*^9}, {
   3.778888110783555*^9, 3.778888198861709*^9}, {3.778888594980234*^9, 
   3.7788886150269823`*^9}, {3.778888682390993*^9, 3.7788887127504463`*^9}, {
   3.778888775785583*^9, 3.7788888029618387`*^9}, {3.778888861280507*^9, 
   3.778888929233055*^9}, {3.778888968083014*^9, 3.778888990320881*^9}, {
   3.778940313674917*^9, 3.778940427211225*^9}, {3.778940461500444*^9, 
   3.7789404727059298`*^9}, {3.7789416287929573`*^9, 3.778941730104414*^9}, {
   3.778941807247459*^9, 3.778941838603115*^9}, {3.778942514562607*^9, 
   3.7789425270987587`*^9}, {3.7789425717846527`*^9, 3.778942611867812*^9}, {
   3.778942666859762*^9, 3.7789427216076403`*^9}, {3.778943180153627*^9, 
   3.7789431865837393`*^9}, {3.778943658134563*^9, 3.7789436623986607`*^9}, {
   3.778943739001783*^9, 3.7789437557854137`*^9}, {3.778943804730875*^9, 
   3.778943870300468*^9}, {3.7789439800374823`*^9, 3.778943985945547*^9}, {
   3.77894417495498*^9, 3.7789441786847687`*^9}, {3.778944224606402*^9, 
   3.778944225203347*^9}, {3.778944316591362*^9, 3.778944347663368*^9}, {
   3.77894437906749*^9, 3.778944390271131*^9}, {3.77894471079528*^9, 
   3.778944714279375*^9}, {3.778945572953786*^9, 3.778945633639792*^9}, {
   3.778945685550462*^9, 3.778945708348341*^9}, {3.778945847294854*^9, 
   3.7789458656336308`*^9}, {3.7789459012725267`*^9, 
   3.7789459695334873`*^9}, {3.778946003277575*^9, 3.778946058754796*^9}, {
   3.778946099199212*^9, 3.778946231015357*^9}, {3.77894626735009*^9, 
   3.7789462797721977`*^9}, {3.778946757433702*^9, 3.778946816185926*^9}, 
   3.778946847140579*^9, {3.778952480131867*^9, 3.778952505090536*^9}, {
   3.778952950870718*^9, 3.778952978236198*^9}, {3.779026324658127*^9, 
   3.7790263619017143`*^9}, {3.77902641645503*^9, 3.779026725776266*^9}, {
   3.795102733572163*^9, 3.795102757572936*^9}, 3.795102915383415*^9, {
   3.795103096342083*^9, 3.79510312359133*^9}, {3.795103306565949*^9, 
   3.7951033100195103`*^9}, {3.795192841348825*^9, 3.79519293705369*^9}, {
   3.7951955041944113`*^9, 3.7951955209649963`*^9}, {3.795195903842842*^9, 
   3.795195904189618*^9}, {3.795196799058022*^9, 3.795196878059855*^9}, {
   3.797269857027666*^9, 
   3.797269885521627*^9}},ExpressionUUID->"e11112d3-734d-44da-b4da-\
61bfdaf7b79d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Use", " ", "'"}], "//", 
    RowBox[{
     RowBox[{"TeXForm", "'"}], " ", "to", " ", "print", " ", "latex", " ", 
     "code", " ", "for", " ", "the", " ", "equation"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LieBracket", "[", 
     RowBox[{"f_", ",", "g_", ",", "x_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"g", ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], ".", "f"}], " ", "-", "  ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"f", ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], ".", "g"}]}]}], " ", ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"InertiaMatrix", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i11", ",", " ", "i12", ",", " ", "i13"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i21", ",", " ", "i22", ",", " ", "i23"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i31", ",", " ", "i32", ",", " ", "i33"}], "}"}]}], "}"}]}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InertiaMatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "i2", ",", " ", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "i3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Omegatilde", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"-", "\[Omega]3"}], ",", " ", "\[Omega]2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]3", ",", "0", ",", 
       RowBox[{"-", "\[Omega]1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "\[Omega]2"}], ",", "\[Omega]1", ",", "0"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     SuperscriptBox["\[Sigma]1", "2"], "+", 
     SuperscriptBox["\[Sigma]2", "2"], "+", 
     SuperscriptBox["\[Sigma]3", "2"]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bmatrix", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", 
        SuperscriptBox["\[Sigma]", "2"], "+", 
        RowBox[{"2", 
         SuperscriptBox["\[Sigma]1", "2"]}]}], ",", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]1", " ", "\[Sigma]2"}], " ", "-", "\[Sigma]3"}], 
         ")"}]}], ",", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]1", " ", "\[Sigma]3"}], " ", "+", "\[Sigma]2"}], 
         ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]2", " ", "\[Sigma]1"}], " ", "+", "\[Sigma]3"}], 
         ")"}]}], ",", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[Sigma]", "2"], "+", 
        RowBox[{"2", 
         SuperscriptBox["\[Sigma]2", "2"]}]}], ",", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]2", " ", "\[Sigma]3"}], " ", "-", "\[Sigma]1"}], 
         ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]3", " ", "\[Sigma]1"}], " ", "-", "\[Sigma]2"}], 
         ")"}]}], ",", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]3", " ", "\[Sigma]2"}], " ", "+", "\[Sigma]1"}], 
         ")"}]}], ",", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[Sigma]", "2"], "+", 
        RowBox[{"2", 
         SuperscriptBox["\[Sigma]3", "2"]}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OmegaVector", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Omega]1", ",", " ", "\[Omega]2", ",", " ", "\[Omega]3"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SigmaVector", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"\[Sigma]1", ",", "\[Sigma]2", ",", "\[Sigma]3"}], "}"}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"SigmaVector", ",", "OmegaVector"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f0", " ", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], 
      RowBox[{"Bmatrix", ".", "OmegaVector"}]}], ",", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Inverse", "[", "InertiaMatrix", "]"}], ".", "Omegatilde", ".",
        "InertiaMatrix", ".", "OmegaVector"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g1", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Inverse", "[", "InertiaMatrix", "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g2", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Inverse", "[", "InertiaMatrix", "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g3", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Inverse", "[", "InertiaMatrix", "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g4", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f0", ",", "g1", ",", "X"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"[", 
     RowBox[{
      SubscriptBox["f", "0"], ",", 
      SubscriptBox["g", "1"]}], "]"}], " ", "\[Rule]", " ", 
    RowBox[{"good", " ", "lie", " ", "bracket"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g5", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f0", ",", "g2", ",", "X"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"[", 
     RowBox[{
      SubscriptBox["f", "0"], ",", 
      SubscriptBox["g", "1"]}], "]"}], " ", "\[Rule]", " ", 
    RowBox[{"good", " ", "lie", " ", "bracket"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g6", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f0", ",", "g3", ",", "X"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"[", 
     RowBox[{
      SubscriptBox["f", "0"], ",", 
      SubscriptBox["g", "1"]}], "]"}], " ", "\[Rule]", " ", 
    RowBox[{"good", " ", "lie", " ", "bracket"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", " ", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"g1", ",", "g2", ",", "g3", ",", "g4", ",", "g5", ",", "g6"}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", " ", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Det", "[", "\[CapitalDelta]", "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Sigma]1", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Sigma]2", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Sigma]3", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Omega]1", "\[Rule]", " ", "0"}], ",", 
      RowBox[{"\[Omega]2", "\[Rule]", " ", "0"}], ",", 
      RowBox[{"\[Omega]3", "\[Rule]", " ", "0"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.796937269242085*^9, 3.796937336936146*^9}, {
   3.7969373998708143`*^9, 3.7969374073417664`*^9}, {3.796937452924959*^9, 
   3.796937477659979*^9}, {3.796937589185794*^9, 3.796937619080508*^9}, {
   3.796937654152109*^9, 3.796937823542004*^9}, {3.796945665209611*^9, 
   3.796945673824545*^9}, {3.7969457236324244`*^9, 3.796945770665773*^9}, {
   3.796945872460176*^9, 3.796945880013002*^9}, {3.7969459152428617`*^9, 
   3.796945966896482*^9}, {3.796946002728579*^9, 3.796946002807654*^9}, {
   3.7969464115652933`*^9, 3.796946427363783*^9}, 3.7969464606462*^9, {
   3.796946608144423*^9, 3.79694661148878*^9}, {3.796946732217885*^9, 
   3.796946766013678*^9}, {3.796946799291202*^9, 3.79694680488983*^9}, {
   3.796946868850583*^9, 3.796946879432227*^9}, {3.796947100972578*^9, 
   3.796947122234853*^9}, {3.796949361186389*^9, 3.796949362219604*^9}, {
   3.796949443339951*^9, 3.796949448705206*^9}, {3.796949531969746*^9, 
   3.796949604909176*^9}, {3.796949864945282*^9, 3.79694990512562*^9}, {
   3.796950002670031*^9, 3.7969500443619003`*^9}, {3.796950188010296*^9, 
   3.796950268799591*^9}, {3.796950444968561*^9, 3.796950457469756*^9}, {
   3.796950521542714*^9, 3.7969505479786787`*^9}, {3.7969506186758413`*^9, 
   3.7969506285206738`*^9}, {3.796950862597787*^9, 3.7969509022974243`*^9}, {
   3.796950969497974*^9, 3.796951069180368*^9}, 3.796951121479023*^9, {
   3.796951154895049*^9, 3.796951176845147*^9}, {3.796951207697873*^9, 
   3.796951212920684*^9}, {3.7969512591300907`*^9, 3.7969512596553707`*^9}, {
   3.796951537195056*^9, 3.7969515542172003`*^9}, {3.796951627888612*^9, 
   3.796951755070938*^9}, 3.796951785198102*^9, {3.79695183550613*^9, 
   3.796952028995982*^9}, {3.7969521179861307`*^9, 3.796952254341177*^9}, {
   3.796952426422688*^9, 3.7969524551509953`*^9}, {3.796952662783845*^9, 
   3.796952697034436*^9}, {3.796955769021522*^9, 3.7969557769269876`*^9}, {
   3.796956360844886*^9, 3.7969567424659147`*^9}, {3.7970197782486258`*^9, 
   3.797019779556697*^9}, {3.7970939658544197`*^9, 3.797093966237103*^9}, {
   3.797197921441566*^9, 3.797197961638812*^9}},
 CellLabel->
  "In[613]:=",ExpressionUUID->"74b649d0-6b7c-4788-81b8-876067159050"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Use", " ", "'"}], "//", 
    RowBox[{
     RowBox[{"TeXForm", "'"}], " ", "to", " ", "print", " ", "latex", " ", 
     "code", " ", "for", " ", "the", " ", "equation"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LieBracket", "[", 
     RowBox[{"f_", ",", "g_", ",", "x_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"g", ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], ".", "f"}], " ", "-", "  ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"f", ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], ".", "g"}]}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InertiaMatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "i2", ",", " ", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "i3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Omegatilde", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"-", "\[Omega]3"}], ",", " ", "\[Omega]2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]3", ",", "0", ",", 
       RowBox[{"-", "\[Omega]1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "\[Omega]2"}], ",", "\[Omega]1", ",", "0"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OmegaVector", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Omega]1", ",", " ", "\[Omega]2", ",", " ", "\[Omega]3"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SigmaVector", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Sigma]1", ",", "\[Sigma]2", ",", "\[Sigma]3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rhovec", "  ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Rho]1", ",", "\[Rho]2", ",", "\[Rho]3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rhodotvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Rho]dot1", ",", "\[Rho]dot2", ",", "\[Rho]dot3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rsun", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"Rsun1", ",", " ", "Rsun2", ",", " ", "Rsun3"}], "}"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.340072870520768"}], ",", "1.313064754160098", ",", 
        "0.569238431693544"}], "}"}], "*", 
      SuperscriptBox["10", "8"]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rchief", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"Rc1", ",", "Rc2", ",", "Rc3"}], "}"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "3.715043789993615", ",", "5.920926236105574", ",", 
       "3.756090321418874"}], "}"}], "*", 
     SuperscriptBox["10", "3"]}], "*)"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Vchief", " ", "=", 
   RowBox[{"{", 
    RowBox[{"Vc1", ",", "Vc2", ",", "Vc3"}], "}"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "6.391676981760982"}], ",", "3.977535887958605", ",", 
      "5.182603931556813"}], "}"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"OmegaLVLH", " ", "=", 
   RowBox[{"{", 
    RowBox[{"omega1", ",", "omega2", ",", "omega3"}], "}"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3.213435007722671", ",", 
       RowBox[{"-", "8.828840122603030"}], ",", "1.073905468042001"}], "}"}], 
     "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "5"}]]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"OmegadotLVLH", " ", "=", 
   RowBox[{"{", 
    RowBox[{"omegadot1", ",", "omegadot2", ",", "omegadot3"}], "}"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4.032119742888825", ",", 
       RowBox[{"-", "11.07815794612423"}], ",", "134.7503661745792"}], "}"}], 
     "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "32"}]]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"const1", " ", "=", " ", "0.1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"const2", "  ", "=", " ", "0.5"}], ";", "\[IndentingNewLine]", 
    RowBox[{"const3", " ", "=", " ", "0.2"}], ";", "\[IndentingNewLine]", 
    RowBox[{"PD", " ", "=", " ", 
     RowBox[{"4.526464771838923", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"PC", " ", "=", " ", 
     RowBox[{"4.526464771838923", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"muEarth", " ", "=", " ", 
     RowBox[{"3.986004415", "*", 
      SuperscriptBox["10", "5"]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"\[Sigma]", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     SuperscriptBox["\[Sigma]1", "2"], "+", 
     SuperscriptBox["\[Sigma]2", "2"], "+", 
     SuperscriptBox["\[Sigma]3", "2"]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bmatrix", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "-", 
        SuperscriptBox["\[Sigma]", "2"], "+", 
        RowBox[{"2", 
         SuperscriptBox["\[Sigma]1", "2"]}]}], ",", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]1", " ", "\[Sigma]2"}], " ", "-", "\[Sigma]3"}], 
         ")"}]}], ",", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]1", " ", "\[Sigma]3"}], " ", "+", "\[Sigma]2"}], 
         ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]2", " ", "\[Sigma]1"}], " ", "+", "\[Sigma]3"}], 
         ")"}]}], ",", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[Sigma]", "2"], "+", 
        RowBox[{"2", 
         SuperscriptBox["\[Sigma]2", "2"]}]}], ",", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]2", " ", "\[Sigma]3"}], " ", "-", "\[Sigma]1"}], 
         ")"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]3", " ", "\[Sigma]1"}], " ", "-", "\[Sigma]2"}], 
         ")"}]}], ",", 
       RowBox[{"2", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Sigma]3", " ", "\[Sigma]2"}], " ", "+", "\[Sigma]1"}], 
         ")"}]}], ",", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[Sigma]", "2"], "+", 
        RowBox[{"2", 
         SuperscriptBox["\[Sigma]3", "2"]}]}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n1vec", " ", "=", "  ", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Sigma]", "2"]}], ")"}], "2"]], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"4", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["\[Sigma]1", "2"], "-", 
          SuperscriptBox["\[Sigma]2", "2"], "-", 
          SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Sigma]", "2"]}], ")"}], "2"]}], ",", 
      RowBox[{
       RowBox[{"8", "\[Sigma]1", " ", "\[Sigma]2"}], " ", "+", " ", 
       RowBox[{"4", " ", "\[Sigma]3", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Sigma]", "2"]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"8", "\[Sigma]1", " ", "\[Sigma]3"}], " ", "-", " ", 
       RowBox[{"4", " ", "\[Sigma]2", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Sigma]", "2"]}], ")"}]}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n2vec", " ", "=", "  ", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Sigma]", "2"]}], ")"}], "2"]], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"8", "\[Sigma]2", " ", "\[Sigma]1"}], " ", "-", " ", 
       RowBox[{"4", " ", "\[Sigma]3", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Sigma]", "2"]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"4", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["\[Sigma]1", "2"]}], "+", 
          SuperscriptBox["\[Sigma]2", "2"], "-", 
          SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Sigma]", "2"]}], ")"}], "2"]}], ",", 
      RowBox[{
       RowBox[{"8", "\[Sigma]2", " ", "\[Sigma]3"}], " ", "-", " ", 
       RowBox[{"4", " ", "\[Sigma]1", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Sigma]", "2"]}], ")"}]}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n3vec", " ", "=", " ", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["\[Sigma]", "2"]}], ")"}], "2"]], 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"8", "\[Sigma]3", " ", "\[Sigma]1"}], " ", "+", " ", 
       RowBox[{"4", " ", "\[Sigma]2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Sigma]", "2"]}], ")"}]}]}], ",", 
      RowBox[{
       RowBox[{"8", "\[Sigma]3", " ", "\[Sigma]2"}], " ", "-", " ", 
       RowBox[{"4", " ", "\[Sigma]1", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Sigma]", "2"]}], ")"}]}]}], ",", " ", 
      RowBox[{
       RowBox[{"4", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["\[Sigma]1", "2"]}], "-", 
          SuperscriptBox["\[Sigma]2", "2"], "+", 
          SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Sigma]", "2"]}], ")"}], "2"]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhat", " ", "=", " ", 
   FractionBox["Rchief", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Rchief", ".", "Rchief"}], "]"}]]}], ";", " ", 
  RowBox[{"hhat", " ", "=", " ", 
   FractionBox[
    RowBox[{"Cross", "[", 
     RowBox[{"Rchief", ",", "Vchief"}], "]"}], 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{"Rchief", ",", "Vchief"}], "]"}], ".", 
      RowBox[{"Cross", "[", 
       RowBox[{"Rchief", ",", "Vchief"}], "]"}]}], "]"}]]}], ";", " ", 
  RowBox[{"vhat", " ", "=", " ", 
   RowBox[{"Cross", "[", 
    RowBox[{"hhat", ",", "rhat"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BNmatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"n1vec", ",", "n2vec", ",", "n3vec"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CNmatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"rhat", ",", "vhat", ",", "hhat"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CBmatrix", " ", "=", " ", 
   RowBox[{"CNmatrix", ".", 
    RowBox[{"Transpose", "[", "BNmatrix", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rdeputy", " ", "=", 
   RowBox[{"Rchief", "+", "Rhovec"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rsundeputy", " ", "=", " ", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}], 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}]}], "]"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"asrpDeuty", " ", "=", " ", 
   RowBox[{
    FractionBox["PD", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}]}]], 
    RowBox[{"n3vec", ".", "Rsundeputy"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"const1", " ", "Rsundeputy"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"const2", " ", 
          RowBox[{"n3vec", ".", "Rsundeputy"}]}], "+", " ", "const3"}], ")"}],
        "n3vec"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"asrpChief", " ", "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["PC", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Rsun", " ", "-", " ", "Rchief"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"Rsun", " ", "-", " ", "Rchief"}], ")"}]}]]}], " ", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{"Rsun", " ", "-", " ", "Rchief"}], ")"}], 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Rsun", " ", "-", " ", "Rchief"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"Rsun", " ", "-", " ", "Rchief"}], ")"}]}], "]"}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Delagravity", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["muEarth", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Rdeputy", ".", "Rdeputy"}], "]"}]]}], "Rdeputy"}], "+", " ", 
    
    RowBox[{
     FractionBox["muEarth", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"Rchief", ".", "Rchief"}], "]"}]], 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoriolisEffect", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Cross", "[", 
      RowBox[{"OmegaLVLH", ",", "Rhovec"}], "]"}]}], " ", "-", " ", 
    RowBox[{"2", " ", 
     RowBox[{"Cross", "[", 
      RowBox[{"OmegadotLVLH", ",", "Rhodotvec"}], "]"}]}], " ", "-", " ", 
    RowBox[{"Cross", "[", 
     RowBox[{"OmegaLVLH", ",", 
      RowBox[{"Cross", "[", 
       RowBox[{"OmegaLVLH", ",", "Rhovec"}], "]"}]}], "]"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RelAcceleration", " ", "=", " ", 
    RowBox[{"Delagravity", " ", "+", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CBmatrix", ".", "asrpDeuty"}], " ", "-", " ", "asrpChief"}], 
      ")"}], " ", "+", " ", "CoriolisEffect"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
    "SigmaVector", ",", "OmegaVector", ",", "Rhovec", ",", "Rhodotvec"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", "   ", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], 
      RowBox[{"Bmatrix", ".", "OmegaVector"}]}], ",", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Inverse", "[", "InertiaMatrix", "]"}], ".", "Omegatilde", ".",
        "InertiaMatrix", ".", "OmegaVector"}]}], ",", "Rhodotvec", ",", 
     "RelAcceleration"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g1", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Inverse", "[", "InertiaMatrix", "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g2", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Inverse", "[", "InertiaMatrix", "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g3", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"-", 
      RowBox[{
       RowBox[{"Inverse", "[", "InertiaMatrix", "]"}], ".", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"adf1g1", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f", ",", "g1", ",", "X"}], "]"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"f0", ",", "g1"}], "]"}], " ", "\[Rule]", " ", 
     RowBox[{"good", " ", "lie", " ", "bracket"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"adf1g2", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f", ",", "g2", ",", "X"}], "]"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"f0", ",", "g2"}], "]"}], " ", "\[Rule]", " ", 
     RowBox[{"good", " ", "lie", " ", "bracket"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"adf1g3", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f", ",", "g3", ",", "X"}], "]"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"f0", ",", "g3"}], "]"}], " ", "\[Rule]", " ", 
     RowBox[{"good", " ", "lie", " ", "bracket"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"adf2g1", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f", ",", "adf1g1", ",", "X"}], "]"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"f0", ",", "adf1g1"}], "]"}], " ", "\[Rule]", " ", 
     RowBox[{"good", " ", "lie", " ", 
      RowBox[{"bracket", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"adf2g2", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f", ",", "adf1g2", ",", "X"}], "]"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"f0", ",", "adf1g2"}], "]"}], " ", "\[Rule]", " ", 
     RowBox[{"good", " ", "lie", " ", 
      RowBox[{"bracket", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"adf2g3", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f", ",", "adf1g3", ",", "X"}], "]"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"f0", ",", "adf1g3"}], "]"}], " ", "\[Rule]", " ", 
     RowBox[{"good", " ", "lie", " ", 
      RowBox[{"bracket", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"adf3g1", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f", ",", "adf2g1", ",", "X"}], "]"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"f0", ",", "adf2g1"}], "]"}], " ", "\[Rule]", " ", 
     RowBox[{"good", " ", "lie", " ", 
      RowBox[{"bracket", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"adf3g2", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f", ",", "adf2g2", ",", "X"}], "]"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"f0", ",", "adf2g2"}], "]"}], " ", "\[Rule]", " ", 
     RowBox[{"good", " ", "lie", " ", 
      RowBox[{"bracket", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"adf3g3", " ", "=", " ", 
    RowBox[{"LieBracket", "[", 
     RowBox[{"f", ",", "adf2g3", ",", "X"}], "]"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"[", 
      RowBox[{"f0", ",", "adf2g3"}], "]"}], " ", "\[Rule]", " ", 
     RowBox[{"good", " ", "lie", " ", 
      RowBox[{"bracket", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"\[CapitalDelta]", " ", "=", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
      "g1", ",", "g2", ",", "g3", ",", "adf1g1", ",", "adf1g2", ",", "adf1g3",
        ",", "adf2g1", ",", "adf2g2", ",", "adf2g3", ",", "adf3g1", ",", 
       "adf3g2", ",", "adf3g3"}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"adf3g3", ",", 
       RowBox[{"{", "X", "}"}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]1", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Sigma]2", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Sigma]3", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Omega]1", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Omega]2", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Omega]3", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Rho]1", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Rho]2", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Rho]3", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Rho]dot1", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Rho]dot2", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Rho]dot3", "\[Rule]", "0"}]}], "}"}]}], "//", 
    "MatrixForm"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[CapitalDelta]", " ", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Sigma]1", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Sigma]2", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Sigma]3", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Omega]1", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Omega]2", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Omega]3", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Rho]1", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Rho]2", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Rho]3", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Rho]dot1", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Rho]dot2", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Rho]dot3", "\[Rule]", "0"}]}], "}"}]}], "//", 
    "MatrixForm"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"CBmatrix", ".", "asrpDeuty"}], " ", ",", 
        RowBox[{"{", "Rhovec", "}"}]}], "]"}], "//", "FullSimplify"}], "//", 
     "MatrixForm"}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"CBmatrix", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", "X", "}"}]}], "]"}], "//", "FullSimplify"}], "//", 
  "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.797007076971566*^9, 3.7970071058799753`*^9}, {
   3.7970198569227552`*^9, 3.797019947184001*^9}, {3.7970199794793663`*^9, 
   3.797019982134935*^9}, {3.797020133155612*^9, 3.797020196665381*^9}, {
   3.797020399172017*^9, 3.797020782642003*^9}, {3.7970208129770517`*^9, 
   3.797020843383361*^9}, {3.797020940655458*^9, 3.797020976775256*^9}, {
   3.797021040445043*^9, 3.7970210873771048`*^9}, {3.7970211201147213`*^9, 
   3.7970211214003887`*^9}, {3.797021231685944*^9, 3.797021272819928*^9}, {
   3.797022059507056*^9, 3.7970221298891068`*^9}, {3.7970221859700117`*^9, 
   3.797022193183591*^9}, {3.797022226776012*^9, 3.797022226829587*^9}, {
   3.797022376154215*^9, 3.7970223770014277`*^9}, {3.7970224317124157`*^9, 
   3.797022496520784*^9}, {3.797022670226716*^9, 3.7970227557026787`*^9}, {
   3.797022867808487*^9, 3.797022914126752*^9}, {3.797022959582419*^9, 
   3.797022988045266*^9}, 3.797023040760577*^9, 3.797023112390113*^9, {
   3.797023158312769*^9, 3.797023188907425*^9}, {3.797023597532455*^9, 
   3.7970236010768127`*^9}, 3.797023650255806*^9, {3.797024020567376*^9, 
   3.7970240212162046`*^9}, {3.797024088406069*^9, 3.797024093262498*^9}, {
   3.797024188959841*^9, 3.7970242619391127`*^9}, {3.797024636838807*^9, 
   3.7970246425010843`*^9}, {3.797024686521493*^9, 3.797024716279995*^9}, {
   3.7970247570681458`*^9, 3.797024926696455*^9}, 3.7970249740961037`*^9, 
   3.797025148924893*^9, {3.797025198076418*^9, 3.797025247066551*^9}, {
   3.7970253019133*^9, 3.797025751039591*^9}, {3.797025820206023*^9, 
   3.79702586679428*^9}, {3.7970259020718393`*^9, 3.797026070963282*^9}, {
   3.797026126287036*^9, 3.797026185352352*^9}, {3.797026229940558*^9, 
   3.79702632686056*^9}, {3.797026388381586*^9, 3.7970265557706203`*^9}, {
   3.7970265944998007`*^9, 3.79702659658821*^9}, {3.7970266632570753`*^9, 
   3.797026663335115*^9}, {3.797026727122959*^9, 3.797026762252577*^9}, {
   3.797027516762887*^9, 3.7970275499360523`*^9}, {3.797027680070541*^9, 
   3.797027720107012*^9}, {3.7970278032819557`*^9, 3.797027803336521*^9}, {
   3.797029221155724*^9, 3.7970292212094107`*^9}, {3.7970297685975018`*^9, 
   3.797029846704586*^9}, {3.797029956277597*^9, 3.79703005477682*^9}, {
   3.7970301326255198`*^9, 3.797030133150886*^9}, 3.797033415814707*^9, {
   3.797033528426168*^9, 3.7970335832801437`*^9}, {3.797033709274352*^9, 
   3.797033723808584*^9}, {3.7970338581032248`*^9, 3.797033872809697*^9}, {
   3.797033959276876*^9, 3.7970340526987886`*^9}, {3.797082150811265*^9, 
   3.797082192374277*^9}, {3.7970822389092607`*^9, 3.797082250997119*^9}, {
   3.797082282832468*^9, 3.7970824089396973`*^9}, {3.7970824854337378`*^9, 
   3.7970825443353233`*^9}, {3.797082610324121*^9, 3.7970826266344147`*^9}, {
   3.797082669131317*^9, 3.7970827234049387`*^9}, {3.797082762012745*^9, 
   3.79708286313846*^9}, {3.797082920450321*^9, 3.7970829221936493`*^9}, {
   3.797082960233295*^9, 3.79708301015942*^9}, {3.797083090849492*^9, 
   3.797083095545331*^9}, {3.797083141837112*^9, 3.79708329280726*^9}, {
   3.797083339979239*^9, 3.797083346745278*^9}, {3.79708340100706*^9, 
   3.7970834022406063`*^9}, {3.797083463960373*^9, 3.797083471253972*^9}, {
   3.797083516210326*^9, 3.797083536979966*^9}, 3.797083636358994*^9, {
   3.797083897845169*^9, 3.797083902506496*^9}, 3.79708393735122*^9, {
   3.797083979722803*^9, 3.7970839823763227`*^9}, {3.79708870391757*^9, 
   3.79708872284823*^9}, 3.7970950002929707`*^9, {3.797179917708189*^9, 
   3.7971799775638237`*^9}, 3.797180023749868*^9, {3.797180299311728*^9, 
   3.797180318681567*^9}, {3.797180368585094*^9, 3.79718059168181*^9}, {
   3.7971807048391733`*^9, 3.797180769519793*^9}, {3.797180808070674*^9, 
   3.79718082317026*^9}, {3.797182452056178*^9, 3.7971824544739923`*^9}, {
   3.797182489807857*^9, 3.797182494797432*^9}, 3.79718252910839*^9, {
   3.797193168202273*^9, 3.797193214744309*^9}, {3.7971934438353567`*^9, 
   3.797193568885538*^9}, {3.797193764669088*^9, 3.7971937981588297`*^9}, {
   3.797193830434383*^9, 3.797193859660563*^9}, {3.7971941231885233`*^9, 
   3.797194340599791*^9}, {3.797194399353211*^9, 3.797194479420105*^9}, 
   3.79719452091369*^9, {3.797194561800334*^9, 3.79719459460883*^9}, {
   3.797195005527776*^9, 3.797195054644643*^9}, {3.79719510745783*^9, 
   3.797195128196456*^9}, {3.797195178938686*^9, 3.7971952186149178`*^9}, {
   3.797195307350504*^9, 3.7971953847738323`*^9}, 3.797197348334778*^9, {
   3.797197404505464*^9, 3.797197434739634*^9}, {3.7971979708241453`*^9, 
   3.7971982021823263`*^9}, {3.797198388513907*^9, 3.797198459846933*^9}, {
   3.7971989386397953`*^9, 3.797199042487496*^9}, 3.797199081678629*^9, {
   3.797199219922245*^9, 3.797199232064945*^9}, {3.797206020630384*^9, 
   3.797206078094615*^9}, {3.797206330675644*^9, 3.797206383995322*^9}, {
   3.797206534345955*^9, 3.797206678834412*^9}, {3.797206785448543*^9, 
   3.7972067981060658`*^9}, 3.797206981910923*^9, {3.797207096984879*^9, 
   3.7972071525694532`*^9}, {3.797245529533436*^9, 3.797245546711919*^9}, {
   3.7972634637642193`*^9, 3.7972634640952797`*^9}, {3.797263833501668*^9, 
   3.797263866208149*^9}, 3.797263984375381*^9, 3.797264057351048*^9, {
   3.797264475088584*^9, 3.797264514681053*^9}, {3.79726579169621*^9, 
   3.797265794121462*^9}, {3.797266505978772*^9, 3.7972665116820383`*^9}, 
   3.797266548582386*^9, {3.7972698940718803`*^9, 3.797269935880951*^9}, {
   3.797337539112979*^9, 3.797337572490615*^9}, {3.797337980112536*^9, 
   3.797337987638103*^9}, {3.79733806230182*^9, 3.797338062355473*^9}, {
   3.797338161379661*^9, 3.797338181419615*^9}, {3.7973387293401527`*^9, 
   3.797338733585197*^9}, {3.797338923329205*^9, 3.797339036136126*^9}, 
   3.797339068827869*^9, 3.797339356454464*^9, {3.7973415323887043`*^9, 
   3.7973415893959913`*^9}, {3.797341625073058*^9, 3.797341631303639*^9}, {
   3.797341670079158*^9, 3.79734167603732*^9}, {3.797341712298386*^9, 
   3.797341750816105*^9}, {3.797341798306241*^9, 3.797341802200212*^9}, {
   3.797341862273286*^9, 3.79734189845544*^9}, {3.797342057443893*^9, 
   3.797342101107019*^9}, {3.7973421632271214`*^9, 3.797342179680929*^9}, {
   3.797342213354226*^9, 3.797342215791709*^9}, {3.797356685552281*^9, 
   3.797356723671221*^9}, {3.797356753701426*^9, 3.7973567581828547`*^9}, 
   3.7973604684449263`*^9, 3.797361549314971*^9, {3.797363368273041*^9, 
   3.7973633743973846`*^9}, {3.804507001596628*^9, 3.8045070019030113`*^9}, {
   3.804539723796898*^9, 3.804539738771225*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"771bbf93-0f50-4b24-9ac9-44f18855875d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"8", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "Rc1", " ", "\[Sigma]1", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[Sigma]2", "2"], "+", 
             SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}], "+", 
          RowBox[{"Rc2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[Sigma]2", "3"], "+", 
             RowBox[{"\[Sigma]1", " ", 
              SuperscriptBox["\[Sigma]2", "2"], " ", "\[Sigma]3"}], "+", 
             RowBox[{"\[Sigma]2", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"3", " ", 
                 SuperscriptBox["\[Sigma]1", "2"]}], "+", 
                SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}], "+", 
             RowBox[{"\[Sigma]1", " ", "\[Sigma]3", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                SuperscriptBox["\[Sigma]1", "2"], "+", 
                SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"Rc3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["\[Sigma]1", "3"]}], " ", "\[Sigma]2"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["\[Sigma]1", "2"], " ", "\[Sigma]3"}], "-", 
             RowBox[{"\[Sigma]1", " ", "\[Sigma]2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                SuperscriptBox["\[Sigma]2", "2"], "+", 
                SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}], "+", 
             RowBox[{"\[Sigma]3", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["\[Sigma]2", "2"], "+", 
                SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["Rc1", "2"], "+", 
          SuperscriptBox["Rc2", "2"], "+", 
          SuperscriptBox["Rc3", "2"]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Sigma]1", "2"], "+", 
           SuperscriptBox["\[Sigma]2", "2"], "+", 
           SuperscriptBox["\[Sigma]3", "2"]}], ")"}], "3"]}]], 
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "Rc1", " ", "\[Sigma]2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             SuperscriptBox["\[Sigma]1", "2"], "+", 
             SuperscriptBox["\[Sigma]2", "2"], "+", 
             SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}], "+", 
          RowBox[{"2", " ", "Rc2", " ", 
           RowBox[{"(", 
            RowBox[{"\[Sigma]1", "+", 
             SuperscriptBox["\[Sigma]1", "3"], "-", 
             RowBox[{"3", " ", "\[Sigma]1", " ", 
              SuperscriptBox["\[Sigma]2", "2"]}], "+", 
             RowBox[{"\[Sigma]2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                SuperscriptBox["\[Sigma]1", "2"], "+", 
                SuperscriptBox["\[Sigma]2", "2"]}], ")"}], " ", "\[Sigma]3"}],
              "+", 
             RowBox[{"\[Sigma]1", " ", 
              SuperscriptBox["\[Sigma]3", "2"]}], "+", 
             RowBox[{"\[Sigma]2", " ", 
              SuperscriptBox["\[Sigma]3", "3"]}]}], ")"}]}], "+", 
          RowBox[{"Rc3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[Sigma]1", "4"], "+", 
             RowBox[{"6", " ", 
              SuperscriptBox["\[Sigma]2", "2"]}], "-", 
             SuperscriptBox["\[Sigma]2", "4"], "-", 
             RowBox[{
             "8", " ", "\[Sigma]1", " ", "\[Sigma]2", " ", "\[Sigma]3"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["\[Sigma]1", "2"], " ", 
              SuperscriptBox["\[Sigma]3", "2"]}], "+", 
             SuperscriptBox["\[Sigma]3", "4"]}], ")"}]}]}], ")"}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["Rc1", "2"], "+", 
          SuperscriptBox["Rc2", "2"], "+", 
          SuperscriptBox["Rc3", "2"]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Sigma]1", "2"], "+", 
           SuperscriptBox["\[Sigma]2", "2"], "+", 
           SuperscriptBox["\[Sigma]3", "2"]}], ")"}], "3"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "Rc2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Sigma]1", "2"], "+", 
              SuperscriptBox["\[Sigma]2", "2"]}], ")"}], "2"], "+", 
           RowBox[{
           "8", " ", "\[Sigma]1", " ", "\[Sigma]2", " ", "\[Sigma]3"}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["\[Sigma]3", "2"]}], "-", 
           SuperscriptBox["\[Sigma]3", "4"]}], ")"}]}], "+", 
        RowBox[{"8", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "Rc1", " ", "\[Sigma]3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "-", 
              SuperscriptBox["\[Sigma]1", "2"], "+", 
              SuperscriptBox["\[Sigma]2", "2"], "+", 
              SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}], "+", 
           RowBox[{"Rc3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Sigma]1", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["\[Sigma]1", "2"], "+", 
                 SuperscriptBox["\[Sigma]2", "2"]}], ")"}]}], "-", 
              RowBox[{"\[Sigma]2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "3"}], "+", 
                 SuperscriptBox["\[Sigma]1", "2"], "+", 
                 SuperscriptBox["\[Sigma]2", "2"]}], ")"}], " ", 
               "\[Sigma]3"}], "-", 
              RowBox[{"3", " ", "\[Sigma]1", " ", 
               SuperscriptBox["\[Sigma]3", "2"]}], "-", 
              RowBox[{"\[Sigma]2", " ", 
               SuperscriptBox["\[Sigma]3", "3"]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["Rc1", "2"], "+", 
          SuperscriptBox["Rc2", "2"], "+", 
          SuperscriptBox["Rc3", "2"]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Sigma]1", "2"], "+", 
           SuperscriptBox["\[Sigma]2", "2"], "+", 
           SuperscriptBox["\[Sigma]3", "2"]}], ")"}], "3"]}]], "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "Rc2", " ", "\[Sigma]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[Sigma]1", "2"], "-", 
             SuperscriptBox["\[Sigma]2", "2"], "+", 
             SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}], "+", 
          RowBox[{"2", " ", "Rc1", " ", 
           RowBox[{"(", 
            RowBox[{"\[Sigma]2", "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["\[Sigma]1", "2"], " ", "\[Sigma]2"}], "+", 
             SuperscriptBox["\[Sigma]2", "3"], "-", 
             RowBox[{"\[Sigma]1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                SuperscriptBox["\[Sigma]1", "2"], "+", 
                SuperscriptBox["\[Sigma]2", "2"]}], ")"}], " ", "\[Sigma]3"}],
              "+", 
             RowBox[{"\[Sigma]2", " ", 
              SuperscriptBox["\[Sigma]3", "2"]}], "-", 
             RowBox[{"\[Sigma]1", " ", 
              SuperscriptBox["\[Sigma]3", "3"]}]}], ")"}]}], "+", 
          RowBox[{"Rc3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"6", " ", 
              SuperscriptBox["\[Sigma]1", "2"]}], "-", 
             SuperscriptBox["\[Sigma]1", "4"], "-", 
             RowBox[{
             "8", " ", "\[Sigma]1", " ", "\[Sigma]2", " ", "\[Sigma]3"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Sigma]2", "2"], "+", 
                SuperscriptBox["\[Sigma]3", "2"]}], ")"}], "2"]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["Rc1", "2"], "+", 
          SuperscriptBox["Rc2", "2"], "+", 
          SuperscriptBox["Rc3", "2"]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Sigma]1", "2"], "+", 
           SuperscriptBox["\[Sigma]2", "2"], "+", 
           SuperscriptBox["\[Sigma]3", "2"]}], ")"}], "3"]}]], 
      FractionBox[
       RowBox[{"8", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "Rc2", " ", "\[Sigma]2", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[Sigma]1", "2"], "+", 
             SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}], "+", 
          RowBox[{"Rc1", " ", 
           RowBox[{"(", 
            RowBox[{"\[Sigma]1", "+", 
             SuperscriptBox["\[Sigma]1", "3"], "-", 
             RowBox[{"3", " ", "\[Sigma]1", " ", 
              SuperscriptBox["\[Sigma]2", "2"]}], "-", 
             RowBox[{"\[Sigma]2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                SuperscriptBox["\[Sigma]1", "2"], "+", 
                SuperscriptBox["\[Sigma]2", "2"]}], ")"}], " ", "\[Sigma]3"}],
              "+", 
             RowBox[{"\[Sigma]1", " ", 
              SuperscriptBox["\[Sigma]3", "2"]}], "-", 
             RowBox[{"\[Sigma]2", " ", 
              SuperscriptBox["\[Sigma]3", "3"]}]}], ")"}]}], "+", 
          RowBox[{"Rc3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               SuperscriptBox["\[Sigma]1", "3"]}], " ", "\[Sigma]2"}], "+", 
             "\[Sigma]3", "+", 
             RowBox[{
              SuperscriptBox["\[Sigma]1", "2"], " ", "\[Sigma]3"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["\[Sigma]2", "2"], " ", "\[Sigma]3"}], "+", 
             SuperscriptBox["\[Sigma]3", "3"], "-", 
             RowBox[{"\[Sigma]1", " ", "\[Sigma]2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                SuperscriptBox["\[Sigma]2", "2"], "+", 
                SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["Rc1", "2"], "+", 
          SuperscriptBox["Rc2", "2"], "+", 
          SuperscriptBox["Rc3", "2"]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Sigma]1", "2"], "+", 
           SuperscriptBox["\[Sigma]2", "2"], "+", 
           SuperscriptBox["\[Sigma]3", "2"]}], ")"}], "3"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"4", " ", "Rc1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[Sigma]1", "2"], "+", 
              SuperscriptBox["\[Sigma]2", "2"]}], ")"}], "2"], "-", 
           RowBox[{
           "8", " ", "\[Sigma]1", " ", "\[Sigma]2", " ", "\[Sigma]3"}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["\[Sigma]3", "2"]}], "-", 
           SuperscriptBox["\[Sigma]3", "4"]}], ")"}]}], "+", 
        RowBox[{"8", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "Rc2", " ", "\[Sigma]3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["\[Sigma]1", "2"], "-", 
              SuperscriptBox["\[Sigma]2", "2"], "+", 
              SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}], "+", 
           RowBox[{"Rc3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Sigma]2", " ", 
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SuperscriptBox["\[Sigma]1", "2"], "+", 
                 SuperscriptBox["\[Sigma]2", "2"]}], ")"}]}], "-", 
              RowBox[{"\[Sigma]1", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "3"}], "+", 
                 SuperscriptBox["\[Sigma]1", "2"], "+", 
                 SuperscriptBox["\[Sigma]2", "2"]}], ")"}], " ", 
               "\[Sigma]3"}], "-", 
              RowBox[{"3", " ", "\[Sigma]2", " ", 
               SuperscriptBox["\[Sigma]3", "2"]}], "-", 
              RowBox[{"\[Sigma]1", " ", 
               SuperscriptBox["\[Sigma]3", "3"]}]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["Rc1", "2"], "+", 
          SuperscriptBox["Rc2", "2"], "+", 
          SuperscriptBox["Rc3", "2"]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Sigma]1", "2"], "+", 
           SuperscriptBox["\[Sigma]2", "2"], "+", 
           SuperscriptBox["\[Sigma]3", "2"]}], ")"}], "3"]}]], "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "Rc3", " ", "\[Sigma]1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["\[Sigma]1", "2"], "+", 
             SuperscriptBox["\[Sigma]2", "2"], "-", 
             SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}], "+", 
          RowBox[{"Rc2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"6", " ", 
              SuperscriptBox["\[Sigma]1", "2"]}], "-", 
             SuperscriptBox["\[Sigma]1", "4"], "-", 
             RowBox[{
             "8", " ", "\[Sigma]1", " ", "\[Sigma]2", " ", "\[Sigma]3"}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Sigma]2", "2"], "+", 
                SuperscriptBox["\[Sigma]3", "2"]}], ")"}], "2"]}], ")"}]}], 
          "+", 
          RowBox[{"2", " ", "Rc1", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SuperscriptBox["\[Sigma]1", "3"], " ", "\[Sigma]2"}], "-", 
             RowBox[{"3", " ", 
              SuperscriptBox["\[Sigma]1", "2"], " ", "\[Sigma]3"}], "+", 
             RowBox[{"\[Sigma]1", " ", "\[Sigma]2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                SuperscriptBox["\[Sigma]2", "2"], "+", 
                SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}], "+", 
             RowBox[{"\[Sigma]3", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                SuperscriptBox["\[Sigma]2", "2"], "+", 
                SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["Rc1", "2"], "+", 
          SuperscriptBox["Rc2", "2"], "+", 
          SuperscriptBox["Rc3", "2"]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Sigma]1", "2"], "+", 
           SuperscriptBox["\[Sigma]2", "2"], "+", 
           SuperscriptBox["\[Sigma]3", "2"]}], ")"}], "3"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"16", " ", "Rc3", " ", "\[Sigma]2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[Sigma]1", "2"], "+", 
           SuperscriptBox["\[Sigma]2", "2"], "-", 
           SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}], "-", 
        RowBox[{"4", " ", "Rc1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["\[Sigma]1", "4"], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["\[Sigma]2", "2"]}], "-", 
           SuperscriptBox["\[Sigma]2", "4"], "+", 
           RowBox[{
           "8", " ", "\[Sigma]1", " ", "\[Sigma]2", " ", "\[Sigma]3"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Sigma]1", "2"], " ", 
            SuperscriptBox["\[Sigma]3", "2"]}], "+", 
           SuperscriptBox["\[Sigma]3", "4"]}], ")"}]}], "+", 
        RowBox[{"8", " ", "Rc2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["\[Sigma]1", "3"]}], " ", "\[Sigma]2"}], "+", 
           "\[Sigma]3", "+", 
           RowBox[{
            SuperscriptBox["\[Sigma]1", "2"], " ", "\[Sigma]3"}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["\[Sigma]2", "2"], " ", "\[Sigma]3"}], "+", 
           SuperscriptBox["\[Sigma]3", "3"], "-", 
           RowBox[{"\[Sigma]1", " ", "\[Sigma]2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", 
              SuperscriptBox["\[Sigma]2", "2"], "+", 
              SuperscriptBox["\[Sigma]3", "2"]}], ")"}]}]}], ")"}]}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["Rc1", "2"], "+", 
          SuperscriptBox["Rc2", "2"], "+", 
          SuperscriptBox["Rc3", "2"]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Sigma]1", "2"], "+", 
           SuperscriptBox["\[Sigma]2", "2"], "+", 
           SuperscriptBox["\[Sigma]3", "2"]}], ")"}], "3"]}]], 
      FractionBox[
       RowBox[{"8", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Rc1", " ", "\[Sigma]1"}], "+", 
             RowBox[{"Rc2", " ", "\[Sigma]2"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["\[Sigma]1", "2"], "+", 
             SuperscriptBox["\[Sigma]2", "2"]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", "Rc1", " ", "\[Sigma]2"}], "-", 
             RowBox[{"Rc2", " ", "\[Sigma]1", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", 
                SuperscriptBox["\[Sigma]1", "2"], "+", 
                SuperscriptBox["\[Sigma]2", "2"]}], ")"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"4", " ", "Rc3"}], "+", 
                RowBox[{"Rc1", " ", "\[Sigma]2"}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["\[Sigma]1", "2"], "+", 
                SuperscriptBox["\[Sigma]2", "2"]}], ")"}]}]}], ")"}], " ", 
           "\[Sigma]3"}], "-", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Rc1", " ", "\[Sigma]1"}], "+", 
             RowBox[{"Rc2", " ", "\[Sigma]2"}]}], ")"}], " ", 
           SuperscriptBox["\[Sigma]3", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "Rc2"}], " ", "\[Sigma]1"}], "+", 
             RowBox[{"Rc1", " ", "\[Sigma]2"}]}], ")"}], " ", 
           SuperscriptBox["\[Sigma]3", "3"]}]}], ")"}]}], 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox["Rc1", "2"], "+", 
          SuperscriptBox["Rc2", "2"], "+", 
          SuperscriptBox["Rc3", "2"]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["\[Sigma]1", "2"], "+", 
           SuperscriptBox["\[Sigma]2", "2"], "+", 
           SuperscriptBox["\[Sigma]3", "2"]}], ")"}], "3"]}]], "0", "0", "0", 
      "0", "0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8045397559740553`*^9},
 CellLabel->
  "Out[173]//MatrixForm=",ExpressionUUID->"b570fe40-cb08-4863-b73a-\
338d33fbd8ac"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Jmatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"j11", ",", "j12", ",", "j13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j21", ",", "j22", ",", "j23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j31", ",", "j32", ",", "j33"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Imatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i11", ",", " ", "i12", ",", " ", "i13"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i21", ",", " ", "i22", ",", " ", "i23"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i31", ",", " ", "i32", ",", " ", "i33"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Omegatilde", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"-", "\[Omega]3"}], ",", " ", "\[Omega]2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Omega]3", ",", "0", ",", 
       RowBox[{"-", "\[Omega]1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "\[Omega]2"}], ",", "\[Omega]1", ",", "0"}], "}"}]}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OmegaVector", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Omega]1", ",", " ", "\[Omega]2", ",", " ", "\[Omega]3"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Omegadot", " ", "=", " ", 
   RowBox[{"-", 
    RowBox[{
    "Jmatrix", ".", "Omegatilde", ".", "Imatrix", ".", "OmegaVector"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"Omegadot", ",", "\[Omega]1"}], "]"}], "//", "Simplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"Omegadot", ",", "\[Omega]2"}], "]"}], "//", "FullSimplify"}], "//",
   "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"Omegadot", ",", "\[Omega]3"}], "]"}], "//", "FullSimplify"}], "//",
   "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.7973508015944757`*^9, 3.797350993504139*^9}, {
  3.797351024036963*^9, 3.7973510666405563`*^9}, {3.797351204735032*^9, 
  3.797351255612096*^9}},
 CellLabel->
  "In[445]:=",ExpressionUUID->"954eb9c5-d2c3-4d77-b646-1fb8171741c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "ToMatlab`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"X", " ", "=", " ", "u"}], ";", " ", 
   RowBox[{"Y", " ", "=", " ", "v"}], ";", " ", 
   RowBox[{"Z", " ", "=", 
    RowBox[{
     RowBox[{"a", " ", 
      SuperscriptBox["u", "2"]}], " ", "+", 
     RowBox[{"b", " ", 
      SuperscriptBox["v", "2"]}], " ", "+", 
     RowBox[{"c", " ", "u", " ", "v"}], " ", "+", " ", 
     RowBox[{"d", " ", "u"}], " ", "+", " ", 
     RowBox[{"e", " ", "v"}], " ", "+", " ", "f"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"X", " ", "=", " ", 
     RowBox[{
      RowBox[{"Cos", "[", "u", "]"}], " ", 
      RowBox[{"Cos", "[", "v", "]"}]}]}], ";", " ", 
    RowBox[{"Y", " ", "=", " ", 
     RowBox[{
      RowBox[{"Sin", "[", "u", "]"}], " ", 
      RowBox[{"Cos", "[", "v", "]"}]}]}], ";", " ", 
    RowBox[{"Z", " ", "=", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "v", "]"}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y", ",", "Z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uvec", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"rvec", ",", "u"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vvec", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"rvec", ",", "v"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"duduvec", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"uvec", ",", "u"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dvduvec", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"uvec", ",", "v"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dudvvec", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"vvec", ",", "u"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dvdvvec", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"vvec", ",", "v"}], "]"}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AMatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"uvec", ".", "uvec"}], ",", " ", 
       RowBox[{"uvec", ".", "vvec"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vvec", ".", "uvec"}], ",", " ", 
       RowBox[{"vvec", ".", "vvec"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AInverse", " ", "=", " ", 
    RowBox[{"Inverse", "[", "AMatrix", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gammauuu", " ", "=", " ", 
   RowBox[{"duduvec", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "uvec"}], "+", " ", 
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], "vvec"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gammauuv", " ", "=", " ", 
   RowBox[{"dudvvec", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "uvec"}], "+", " ", 
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], "vvec"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gammauvu", " ", "=", " ", 
   RowBox[{"dvduvec", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "uvec"}], "+", " ", 
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], "vvec"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gammauvv", " ", "=", " ", 
    RowBox[{"dvdvvec", ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"AInverse", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "uvec"}], "+", " ", 
       RowBox[{
        RowBox[{"AInverse", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "vvec"}]}], " ", ")"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gammavuu", " ", "=", " ", 
   RowBox[{"duduvec", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "uvec"}], "+", " ", 
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "vvec"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gammavuv", " ", "=", " ", 
   RowBox[{"dudvvec", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "uvec"}], "+", " ", 
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "vvec"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gammavvu", " ", "=", " ", 
   RowBox[{"dvduvec", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "uvec"}], "+", " ", 
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "vvec"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gammavvv", " ", "=", " ", 
    RowBox[{"dvdvvec", ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"AInverse", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "uvec"}], "+", " ", 
       RowBox[{
        RowBox[{"AInverse", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], "vvec"}]}], " ", ")"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GammaU", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Gammauuu", ",", "Gammauuv"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Gammauvu", ",", "Gammauvv"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GammaV", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Gammavuu", ",", "Gammavuv"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Gammavvu", ",", "Gammavvv"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uddot", " ", "=", " ", 
   RowBox[{"-", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"udot", ",", "vdot"}], "}"}], ".", "GammaU", ".", 
     RowBox[{"{", 
      RowBox[{"udot", ",", "vdot"}], "}"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vddot", " ", "=", " ", 
    RowBox[{"-", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"udot", ",", "vdot"}], "}"}], ".", "GammaV", ".", 
      RowBox[{"{", 
       RowBox[{"udot", ",", "vdot"}], "}"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToMatlab", "[", 
   RowBox[{"uddot", ",", "\"\<uddot\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToMatlab", "[", 
   RowBox[{"vddot", ",", "\"\<vddot\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AMatrix", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GammaU", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GammaV", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"uddot", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vddot", "//", "FullSimplify"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.800554431444545*^9, 3.800554582017954*^9}, {
   3.800554624536339*^9, 3.800554666061653*^9}, {3.800554707920033*^9, 
   3.8005547957804317`*^9}, {3.800555126108439*^9, 3.800555138922509*^9}, {
   3.800555187697844*^9, 3.8005553966053743`*^9}, {3.800555426995059*^9, 
   3.8005555853353367`*^9}, {3.8005556313890553`*^9, 3.800555671034896*^9}, {
   3.8005559453977947`*^9, 3.8005559586983213`*^9}, 3.800556177397045*^9, {
   3.8005564864221973`*^9, 3.800556662070376*^9}, 3.800556709360138*^9, {
   3.800556798629648*^9, 3.8005569228421373`*^9}, {3.800614890980743*^9, 
   3.8006148922768106`*^9}, {3.801402645330986*^9, 3.801402773674963*^9}, {
   3.801405050631444*^9, 3.801405148447472*^9}, {3.801409176908287*^9, 
   3.801409269099183*^9}, {3.801409306362814*^9, 3.801409331974845*^9}, {
   3.801409372808106*^9, 3.80140937785056*^9}, {3.8014094211454372`*^9, 
   3.8014094245803413`*^9}, {3.801476070639104*^9, 3.8014760814507027`*^9}, {
   3.801476196728725*^9, 3.801476287655493*^9}, {3.801476370953719*^9, 
   3.801476413505725*^9}, {3.804537506681571*^9, 3.8045375297756557`*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"d4846d1e-c957-4798-b4da-26b9024c1d65"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Use", " ", "'"}], "//", 
    RowBox[{
     RowBox[{"TeXForm", "'"}], " ", "to", " ", "print", " ", "latex", " ", 
     "code", " ", "for", " ", "the", " ", "equation"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", " ", "=", " ", 
   RowBox[{"r", " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], ";", " ", 
  RowBox[{"Y", "=", 
   RowBox[{"r", " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"X", ",", "Y"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rvec", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"Rvec", ",", "r"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tvec", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"Rvec", ",", "\[Theta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drdrvec", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"rvec", ",", "r"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtdrvec", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"rvec", ",", "\[Theta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"drdtvec", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"tvec", ",", "r"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dtdtvec", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"tvec", ",", "\[Theta]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AMatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"rvec", ".", "rvec"}], ",", " ", 
       RowBox[{"rvec", ".", "tvec"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"tvec", ".", "rvec"}], ",", " ", 
       RowBox[{"tvec", ".", "tvec"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AInverse", " ", "=", " ", 
    RowBox[{"Inverse", "[", "AMatrix", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gammarrr", " ", "=", " ", 
   RowBox[{"drdrvec", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "rvec"}], "+", " ", 
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], "tvec"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gammarrt", " ", "=", " ", 
   RowBox[{"drdtvec", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "rvec"}], "+", " ", 
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], "tvec"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gammartr", " ", "=", " ", 
   RowBox[{"dtdrvec", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "rvec"}], "+", " ", 
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], "tvec"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gammartt", " ", "=", " ", 
    RowBox[{"dtdtvec", ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"AInverse", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "rvec"}], "+", " ", 
       RowBox[{
        RowBox[{"AInverse", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], "tvec"}]}], " ", ")"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gammatrr", " ", "=", " ", 
   RowBox[{"drdrvec", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "rvec"}], "+", " ", 
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "tvec"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gammatrt", " ", "=", " ", 
   RowBox[{"drdtvec", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "rvec"}], "+", " ", 
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "tvec"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gammattr", " ", "=", " ", 
   RowBox[{"dtdrvec", ".", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "rvec"}], "+", " ", 
      RowBox[{
       RowBox[{"AInverse", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}], "tvec"}]}], " ", ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Gammattt", " ", "=", " ", 
    RowBox[{"dtdtvec", ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"AInverse", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}], " ", "rvec"}], "+", " ", 
       RowBox[{
        RowBox[{"AInverse", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "2"}], "]"}], "]"}], "tvec"}]}], " ", ")"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AMatrix", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AInverse", "//", "FullSimplify"}], "//", "MatrixForm"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GammaR", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Gammarrr", ",", "Gammarrt"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Gammartr", ",", "Gammartt"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GammaT", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Gammatrr", ",", "Gammatrt"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Gammattr", ",", "Gammattt"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eq1", " ", "=", " ", 
   RowBox[{"rddot", " ", "+", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"rdot", ",", "tdot"}], "}"}], ".", "GammaR", ".", 
     RowBox[{"{", 
      RowBox[{"rdot", ",", "tdot"}], "}"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Eq2", " ", "=", " ", 
    RowBox[{"tddot", " ", "+", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rdot", ",", "tdot"}], "}"}], ".", "GammaT", ".", 
      RowBox[{"{", 
       RowBox[{"rdot", ",", "tdot"}], "}"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AMatrix", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GammaR", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GammaT", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eq1", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Eq2", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8008214780430393`*^9, 3.800821583726259*^9}, {
   3.800821639429769*^9, 3.800821694932506*^9}, {3.80082180974535*^9, 
   3.8008218587323847`*^9}, {3.8008223674430428`*^9, 3.800822369207567*^9}, {
   3.800822498189583*^9, 3.8008225347155857`*^9}, {3.800822565549046*^9, 
   3.800822566778535*^9}, {3.800822689392811*^9, 3.800822695119132*^9}, {
   3.800822859819766*^9, 3.800822917304888*^9}, {3.8008229763846703`*^9, 
   3.800823211236312*^9}, {3.800823348737118*^9, 3.800823406335372*^9}, {
   3.800823439774619*^9, 3.80082355054025*^9}, {3.800823588257038*^9, 
   3.800823592145771*^9}, 3.80082369197227*^9, {3.800823733773871*^9, 
   3.800823766767153*^9}, {3.800826871220896*^9, 3.8008268738363543`*^9}, {
   3.800826954899172*^9, 3.800826963472849*^9}, {3.800827013698488*^9, 
   3.8008270575884323`*^9}, {3.800827176844226*^9, 3.800827198540283*^9}, {
   3.800827476307213*^9, 3.800827476468306*^9}, {3.8008277124055023`*^9, 
   3.800827718343072*^9}, {3.800827800523739*^9, 3.8008278241893377`*^9}, {
   3.800829696339924*^9, 3.800829700680232*^9}, {3.800831088261373*^9, 
   3.8008310928103943`*^9}, {3.800831381813346*^9, 3.80083139237129*^9}, {
   3.80140945355305*^9, 3.801409577802677*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"b4fa0279-e76c-4f92-9046-d463cfcc64a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "oneStepOrtogonalize", "]"}], ";", " ", 
  RowBox[{"Clear", "[", "GSOrthogonalize", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"oneStepOrtogonalize", "[", 
    RowBox[{"vec_List", ",", 
     RowBox[{"{", "}"}]}], "]"}], ":=", "vec"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"oneStepOrtogonalize", "[", 
    RowBox[{"vec_List", ",", 
     RowBox[{"vecmat_", "?", "MatrixQ"}]}], "]"}], ":=", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#1", "-", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"vec", ".", "#2"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"#2", ".", "#2"}], ")"}]}], "*", "#2"}]}], ")"}], "&"}], 
     ",", "vec", ",", "vecmat"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GSOrthogonalize", "[", 
     RowBox[{"startvecs_", "?", "MatrixQ"}], "]"}], ":=", 
    RowBox[{"Fold", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#1", ",", 
         RowBox[{"oneStepOrtogonalize", "[", 
          RowBox[{"#2", ",", "#1"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", "}"}], ",", "startvecs"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"state", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"r", ",", "t", ",", "rdot", ",", "tdot"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"1", "/", "Mass"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"r", " ", "Mass"}], ")"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"f1", ",", "f2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fc", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fbar", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"Fc", ",", "F"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dconst", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"k", ",", "k", ",", "1", ",", "1"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HMat", " ", "=", "  ", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Inverse", "[", "Fbar", "]"}], "]"}], ".", "Dconst", ".", 
    RowBox[{"Inverse", "[", "Fbar", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prHMat", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{"HMat", ",", "r"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fD", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"rdot", ",", "tdot", ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", "Mass"], "g", " ", 
       RowBox[{"Cos", "[", "t", "]"}]}], " ", "+", " ", 
      RowBox[{"r", " ", 
       SuperscriptBox["tdot", "2"]}]}], ",", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        RowBox[{"r", " ", "Mass"}]], "g", " ", 
       RowBox[{"Sin", "[", "t", "]"}]}], " ", " ", "-", 
      RowBox[{"2", " ", "rdot", " ", 
       RowBox[{"tdot", "/", "r"}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pfD", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{"fD", ",", 
      RowBox[{"{", "state", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", " ", "=", " ", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"t", "-", "Tmin"}], ")"}], "2"], "-", 
     SuperscriptBox["Rtheta", "2"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"t", "-", "Tmin"}], ")"}], "2"]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", " ", "=", " ", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"t", "-", "Tmax"}], ")"}], "2"], "-", 
     SuperscriptBox["Rtheta", "2"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"t", "-", "Tmax"}], ")"}], "2"]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b3", " ", "=", "  ", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"r", "-", "Rmin"}], ")"}], "2"], "-", 
     SuperscriptBox["Rradius", "2"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"r", "-", "Rmin"}], ")"}], "2"]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b4", " ", "=", " ", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"r", "-", "Rmax"}], ")"}], "2"], "-", 
     SuperscriptBox["Rradius", "2"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"r", "-", "Rmax"}], ")"}], "2"]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constraint", " ", "=", " ", 
   RowBox[{"1", "+", "b1", "+", "b2", "+", "b3", "+", "b4"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pb1", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"b1", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pb2", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"b2", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pb3", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"b3", ",", "r"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pb4", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{"b4", ",", "r"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fu", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fstar1", "  ", "=", 
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"F", ".", 
      RowBox[{"Transpose", "[", "F", "]"}]}], "]"}], ".", "F"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fstar2", " ", "=", " ", 
   RowBox[{"Fu", ".", 
    RowBox[{"Inverse", "[", "Fbar", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fstar1", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fstar2", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fbar", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HMat", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"prHMat", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fD", "//", "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pfD", "//", "MatrixForm"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pb1", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pb2", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pb3", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pb4", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.802703009827899*^9, 3.802703195361289*^9}, {
   3.802703263819751*^9, 3.8027032945993013`*^9}, {3.802703611073946*^9, 
   3.80270375116959*^9}, {3.802703912942326*^9, 3.802704112199815*^9}, {
   3.802704210173189*^9, 3.80270435318795*^9}, {3.802704410233067*^9, 
   3.802704521118533*^9}, {3.802706010674839*^9, 3.802706022194749*^9}, {
   3.802706224226017*^9, 3.802706268960513*^9}, {3.802714826512632*^9, 
   3.802714955947302*^9}, {3.80271499314472*^9, 3.8027149966518717`*^9}, {
   3.80271508669808*^9, 3.8027151530994043`*^9}, {3.8027161003928003`*^9, 
   3.802716123295005*^9}, {3.802716186296269*^9, 3.802716191653823*^9}, 
   3.802735441452881*^9, {3.8027439775506077`*^9, 3.802743986530793*^9}, {
   3.802791926665444*^9, 3.802791943471087*^9}, {3.8027919951550817`*^9, 
   3.802792044879198*^9}, {3.802792078998179*^9, 3.8027921205879297`*^9}, 
   3.802792224948855*^9, {3.8027922689167337`*^9, 3.802792348584094*^9}, 
   3.802792800382056*^9, {3.802799443272596*^9, 3.802799719854032*^9}, {
   3.802799767165867*^9, 3.802799775558042*^9}, {3.802799807776103*^9, 
   3.802799843196504*^9}, {3.802807335355198*^9, 3.802807454041711*^9}, 
   3.802807519754479*^9, {3.802810376540708*^9, 3.802810442992388*^9}, {
   3.80281086358716*^9, 3.802810863745352*^9}, {3.802813394669482*^9, 
   3.8028134095831823`*^9}, {3.8028300034125347`*^9, 
   3.8028300063938837`*^9}, {3.802998571592145*^9, 3.802998574481255*^9}, {
   3.803055223697201*^9, 3.803055234042387*^9}, {3.8030620902279*^9, 
   3.803062109707342*^9}, {3.803083825163289*^9, 3.8030838302899103`*^9}, {
   3.8030842985058193`*^9, 3.80308429976031*^9}, {3.803084812129098*^9, 
   3.803084839855847*^9}, {3.803333493784881*^9, 3.803333499712606*^9}, {
   3.803333551039072*^9, 3.8033335786955633`*^9}, {3.803333623936091*^9, 
   3.803333670527005*^9}, {3.803334204756522*^9, 3.8033343424741173`*^9}, {
   3.803334406007348*^9, 3.803334406321281*^9}, 3.803334516084304*^9, {
   3.803340202384573*^9, 3.803340245239571*^9}, {3.803408670682743*^9, 
   3.803408717020273*^9}, {3.8034089502462463`*^9, 3.803409032778616*^9}, 
   3.8034091347850847`*^9, {3.8034096883725*^9, 3.803409691377832*^9}, {
   3.803409775912071*^9, 3.8034097991243477`*^9}, {3.8034143202486277`*^9, 
   3.803414331685018*^9}, 3.803487860781991*^9, 3.803487904727705*^9, {
   3.803753012744761*^9, 3.8037531137843323`*^9}, {3.8037531965228024`*^9, 
   3.80375323641313*^9}, {3.8037532827313423`*^9, 3.803753313035109*^9}},
 CellLabel->
  "In[416]:=",ExpressionUUID->"99270115-10c5-44b7-a0fa-10355b52ae8e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "oneStepOrtogonalize", "]"}], ";", " ", 
  RowBox[{"Clear", "[", "GSOrthogonalize", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"oneStepOrtogonalize", "[", 
    RowBox[{"vec_List", ",", 
     RowBox[{"{", "}"}]}], "]"}], ":=", "vec"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"oneStepOrtogonalize", "[", 
    RowBox[{"vec_List", ",", 
     RowBox[{"vecmat_", "?", "MatrixQ"}]}], "]"}], ":=", 
   RowBox[{"Fold", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"#1", "-", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"vec", ".", "#2"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"#2", ".", "#2"}], ")"}]}], "*", "#2"}]}], ")"}], "&"}], 
     ",", "vec", ",", "vecmat"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GSOrthogonalize", "[", 
     RowBox[{"startvecs_", "?", "MatrixQ"}], "]"}], ":=", 
    RowBox[{"Fold", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{"#1", ",", 
         RowBox[{"oneStepOrtogonalize", "[", 
          RowBox[{"#2", ",", "#1"}], "]"}]}], "]"}], "&"}], ",", 
      RowBox[{"{", "}"}], ",", "startvecs"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"r", ",", "t", ",", "rdot", ",", "tdot", ",", "u1", ",", "u2"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dconst", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"k", ",", "k", ",", "k", ",", "k", ",", "1", ",", "1"}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HMat", " ", "=", " ", "Dconst"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fD", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"rdot", ",", "tdot", ",", " ", 
     RowBox[{
      RowBox[{"g", " ", 
       RowBox[{
        RowBox[{"Cos", "[", "t", "]"}], "/", "Mass"}]}], " ", "+", " ", 
      RowBox[{"r", " ", 
       SuperscriptBox["tdot", "2"]}], "+", 
      RowBox[{"u1", "/", "Mass"}]}], ",", " ", 
     RowBox[{
      RowBox[{"g", " ", 
       RowBox[{
        RowBox[{"Sin", "[", "t", "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"r", " ", "Mass"}], ")"}]}]}], "  ", "-", 
      RowBox[{"2", " ", "rdot", " ", 
       RowBox[{"tdot", "/", "r"}]}], " ", "+", " ", 
      RowBox[{"u2", "/", 
       RowBox[{"(", 
        RowBox[{"r", " ", "Mass"}], ")"}]}]}], ",", " ", "0", ",", " ", "0"}],
     "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pfD", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{"fD", ",", 
      RowBox[{"{", "state", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b1", " ", "=", " ", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"t", "-", "Tmin"}], ")"}], "2"], "-", 
     SuperscriptBox["Rtheta", "2"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"t", "-", "Tmin"}], ")"}], "2"]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", " ", "=", " ", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"t", "-", "Tmax"}], ")"}], "2"], "-", 
     SuperscriptBox["Rtheta", "2"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"t", "-", "Tmax"}], ")"}], "2"]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b3", " ", "=", "  ", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"r", "-", "Rmin"}], ")"}], "2"], "-", 
     SuperscriptBox["Rradius", "2"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"r", "-", "Rmin"}], ")"}], "2"]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b4", " ", "=", " ", 
   FractionBox[
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"r", "-", "Rmax"}], ")"}], "2"], "-", 
     SuperscriptBox["Rradius", "2"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"r", "-", "Rmax"}], ")"}], "2"]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b5", " ", "=", " ", 
   FractionBox["1", 
    RowBox[{
     SuperscriptBox["u1Max", "2"], " ", "-", " ", 
     SuperscriptBox["u1", "2"]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b6", " ", "=", " ", 
    FractionBox["1", 
     RowBox[{
      SuperscriptBox["u2Max", "2"], " ", "-", " ", 
      SuperscriptBox["u2", "2"]}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constraint", " ", "=", " ", 
   RowBox[{"1", "+", "b1", "+", "b2", "+", "b3", "+", "b4"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pb1", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"b1", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pb2", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"b2", ",", "t"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pb3", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"b3", ",", "r"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pb4", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"b4", ",", "r"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pb5", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"b5", ",", "u1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pb6", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{"b6", ",", "u2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pb5", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pb6", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pfD", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.804171480955676*^9, 3.804171494890605*^9}, {
  3.804172162041819*^9, 3.80417261209081*^9}, {3.804173603602139*^9, 
  3.804173607427668*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"8cbed590-ebce-4d07-9e11-b2717ee027d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lamda", " ", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["l", "2"], "-", 
        SuperscriptBox["R", "2"]}], ")"}], "/", 
      SuperscriptBox["l", "2"]}], ")"}], "2"]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lamda", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"lamda", ",", "l"}], "]"}], "//", "FullSimplify"}], "//", 
   "MatrixForm"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"state", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"r", ",", "t", ",", "rdot", ",", "tdot"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tip", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"r", " ", 
      RowBox[{"Cos", "[", "t", "]"}]}], ",", 
     RowBox[{"r", " ", 
      RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"obs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", " ", 
      RowBox[{"Cos", "[", "w", "]"}]}], ",", 
     RowBox[{"z", " ", 
      RowBox[{"Sin", "[", "w", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"tip", "-", "obs"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"tip", "-", "obs"}], ")"}]}], ")"}], 
    RowBox[{"1", "/", "2"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pl", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"l", ",", 
     RowBox[{"{", "state", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pl", "//", "FullSimplify"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.802790227950829*^9, 3.802790256902717*^9}, {
   3.802790305643965*^9, 3.80279042971663*^9}, {3.8027904856734324`*^9, 
   3.8027905432236233`*^9}, {3.802791790715081*^9, 3.802791798946581*^9}, {
   3.802791843571859*^9, 3.8027919134237022`*^9}, {3.8027924268544292`*^9, 
   3.8027924666533327`*^9}, {3.8027925025197573`*^9, 3.802792693838299*^9}, {
   3.802792726359625*^9, 3.802792732813423*^9}, {3.8027956067018423`*^9, 
   3.8027956103544903`*^9}, {3.802799425985033*^9, 3.802799429039847*^9}, {
   3.802998619345973*^9, 3.8029988643094893`*^9}, {3.802998909443492*^9, 
   3.8029990202428093`*^9}, {3.802999050791263*^9, 3.802999103419511*^9}, {
   3.802999151737502*^9, 3.8029991542086077`*^9}, {3.802999201994576*^9, 
   3.8029992020797777`*^9}, {3.8029992407287188`*^9, 
   3.8029992505850067`*^9}, {3.802999445268154*^9, 3.802999445344858*^9}, 
   3.8029995842837276`*^9, {3.802999629337175*^9, 3.802999636275502*^9}, {
   3.80299976006952*^9, 3.802999809393832*^9}, {3.803000217409389*^9, 
   3.803000233587565*^9}, {3.8030002865790854`*^9, 3.803000372935523*^9}, {
   3.803000404562462*^9, 3.803000430997855*^9}, {3.803000532861236*^9, 
   3.803000534235004*^9}, 3.80300056915694*^9, {3.803000605180217*^9, 
   3.803000605513191*^9}, 3.80300066962838*^9, 3.8030008997350197`*^9, {
   3.803051844379978*^9, 3.803051863296145*^9}, {3.803051958023631*^9, 
   3.803051972591711*^9}, {3.803052053602796*^9, 3.803052059308207*^9}, 
   3.803053290363604*^9, {3.803053561722022*^9, 3.803053565367573*^9}, {
   3.80342413610297*^9, 3.8034241835642977`*^9}},
 CellLabel->
  "In[772]:=",ExpressionUUID->"aa20b7ef-767f-4919-85df-0b1e82c124f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", " ", 
     RowBox[{"Sin", "[", "\[Theta]", "]"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f3", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fbar", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"f3", ",", "f1", ",", "f2"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dconst", " ", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"k", ",", "1", ",", "1"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G1", " ", "=", "  ", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Inverse", "[", "Fbar", "]"}], "]"}], ".", "Dconst", ".", 
    RowBox[{"Inverse", "[", "Fbar", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G2", " ", "=", " ", 
   RowBox[{"Fbar", ".", "Dconst", ".", 
    RowBox[{"Transpose", "[", "Fbar", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ff", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"f1", ",", "f2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fu", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fstar1", "  ", "=", 
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"Ff", ".", 
      RowBox[{"Transpose", "[", "Ff", "]"}]}], "]"}], ".", "Ff"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fstar2", " ", "=", " ", 
    RowBox[{"Fu", ".", 
     RowBox[{"Inverse", "[", "Fbar", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Fstar1", "//", "FullSimplify"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fstar2", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fbar", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G1", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G2", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.803751668701437*^9, 3.803751931812896*^9}, {
   3.803751961883754*^9, 3.803751965038048*^9}, {3.80375241088344*^9, 
   3.803752514562806*^9}, {3.803752549185687*^9, 3.8037527442035913`*^9}, {
   3.803752777487659*^9, 3.8037528194243593`*^9}, {3.8037528905310383`*^9, 
   3.8037529008567343`*^9}, 3.803752933246336*^9, {3.803753171553082*^9, 
   3.8037531898805523`*^9}},ExpressionUUID->"c3dd048d-adff-4caa-baad-\
d710f529a32c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "ToMatlab`"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LieBracket", "[", 
     RowBox[{"f_", ",", "g_", ",", "x_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"g", ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], ".", "f"}], " ", "-", "  ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"f", ",", 
        RowBox[{"{", "x", "}"}]}], "]"}], ".", "g"}]}]}], " ", ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InertiaMatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i1", ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "i2", ",", " ", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "i3"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Omegatilde", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{"-", "omg3"}], ",", " ", "omg2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"omg3", ",", "0", ",", 
       RowBox[{"-", "omg1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "omg2"}], ",", "omg1", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OmegaVector", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"omg1", ",", " ", "omg2", ",", " ", "omg3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Qvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"q0", ",", "q1", ",", "q2", ",", "q3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rhovec", "  ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"rho1", ",", "rho2", ",", "rho3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rhodotvec", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"rhodot1", ",", "rhodot2", ",", "rhodot3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Rsun", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"Rsun1", ",", " ", "Rsun2", ",", " ", "Rsun3"}], "}"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.340072870520768"}], ",", "1.313064754160098", ",", 
        "0.569238431693544"}], "}"}], "*", 
      SuperscriptBox["10", "8"]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rchief", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"Rc1", ",", "Rc2", ",", "Rc3"}], "}"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "3.715043789993615", ",", "5.920926236105574", ",", 
       "3.756090321418874"}], "}"}], "*", 
     SuperscriptBox["10", "3"]}], "*)"}], ";"}], " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Vchief", " ", "=", 
    RowBox[{"{", 
     RowBox[{"Vc1", ",", "Vc2", ",", "Vc3"}], "}"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "6.391676981760982"}], ",", "3.977535887958605", ",", 
       "5.182603931556813"}], "}"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"OmegaLVLH", " ", "=", 
    RowBox[{"{", 
     RowBox[{"omegaCh1", ",", "omegaCh2", ",", "omegaCh3"}], "}"}]}], ";", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3.213435007722671", ",", 
        RowBox[{"-", "8.828840122603030"}], ",", "1.073905468042001"}], "}"}],
       "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "5"}]]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"OmegadotLVLH", " ", "=", 
    RowBox[{"{", 
     RowBox[{"omegaChdot1", ",", "omegaChdot2", ",", "omegaChdot3"}], "}"}]}],
    ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4.032119742888825", ",", 
       RowBox[{"-", "11.07815794612423"}], ",", "134.7503661745792"}], "}"}], 
     "*", 
     SuperscriptBox["10", 
      RowBox[{"-", "32"}]]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"const1", " ", "=", " ", "0.1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"const2", "  ", "=", " ", "0.5"}], ";", "\[IndentingNewLine]", 
    RowBox[{"const3", " ", "=", " ", "0.2"}], ";", "\[IndentingNewLine]", 
    RowBox[{"PD", " ", "=", " ", 
     RowBox[{"4.526464771838923", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"PC", " ", "=", " ", 
     RowBox[{"4.526464771838923", "*", 
      SuperscriptBox["10", 
       RowBox[{"-", "6"}]]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"muEarth", " ", "=", " ", 
     RowBox[{"3.986004415", "*", 
      SuperscriptBox["10", "5"]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n1vec", " ", "=", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"q0", "*", "q0"}], " ", "+", " ", 
      RowBox[{"q1", "*", "q1"}], " ", "-", " ", 
      RowBox[{"q2", "*", "q2"}], " ", "-", " ", 
      RowBox[{"q3", "*", "q3"}]}], ",", " ", 
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q1", "*", "q2"}], " ", "+", " ", 
        RowBox[{"q0", "*", "q3"}]}], ")"}]}], ",", "  ", 
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q1", "*", "q3"}], " ", "-", " ", 
        RowBox[{"q0", "*", "q2"}]}], ")"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n2vec", " ", "=", "  ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q1", "*", "q2"}], " ", "-", " ", 
        RowBox[{"q0", "*", "q3"}]}], ")"}]}], " ", ",", " ", 
     RowBox[{
      RowBox[{"q0", "*", "q0"}], " ", "-", " ", 
      RowBox[{"q1", "*", "q1"}], " ", "+", " ", 
      RowBox[{"q2", "*", "q2"}], " ", "-", " ", 
      RowBox[{"q3", "*", "q3"}]}], ",", "  ", 
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q2", "*", "q3"}], " ", "+", " ", 
        RowBox[{"q0", "*", "q1"}]}], ")"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n3vec", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q1", "*", "q3"}], " ", "+", " ", 
         RowBox[{"q0", "*", "q2"}]}], ")"}]}], ",", "  ", 
      RowBox[{"2", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"q2", "*", "q3"}], " ", "-", " ", 
         RowBox[{"q0", "*", "q1"}]}], ")"}]}], ",", "  ", 
      RowBox[{
       RowBox[{"q0", "*", "q0"}], " ", "-", " ", 
       RowBox[{"q1", "*", "q1"}], " ", "-", " ", 
       RowBox[{"q2", "*", "q2"}], " ", "+", " ", 
       RowBox[{"q3", "*", "q3"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OmegaMatrix", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "omg1"}], ",", " ", 
        RowBox[{"-", "omg2"}], ",", " ", 
        RowBox[{"-", "omg3"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"omg1", ",", " ", "0", ",", " ", "omg3", ",", " ", 
        RowBox[{"-", "omg2"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"omg2", ",", " ", 
        RowBox[{"-", "omg3"}], ",", " ", "0", ",", " ", "omg1"}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"omg3", ",", " ", "omg2", ",", " ", 
        RowBox[{"-", "omg1"}], ",", " ", "0"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rhat", " ", "=", " ", 
   FractionBox["Rchief", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"Rchief", ".", "Rchief"}], "]"}]]}], ";", " ", 
  RowBox[{"hhat", " ", "=", " ", 
   FractionBox[
    RowBox[{"Cross", "[", 
     RowBox[{"Rchief", ",", "Vchief"}], "]"}], 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"Cross", "[", 
       RowBox[{"Rchief", ",", "Vchief"}], "]"}], ".", 
      RowBox[{"Cross", "[", 
       RowBox[{"Rchief", ",", "Vchief"}], "]"}]}], "]"}]]}], ";", " ", 
  RowBox[{"vhat", " ", "=", " ", 
   RowBox[{"Cross", "[", 
    RowBox[{"hhat", ",", "rhat"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BNmatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"n1vec", ",", "n2vec", ",", "n3vec"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CNmatrix", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"rhat", ",", "vhat", ",", "hhat"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CBmatrix", " ", "=", " ", 
   RowBox[{"CNmatrix", ".", 
    RowBox[{"Transpose", "[", "BNmatrix", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rdeputy", " ", "=", 
   RowBox[{"Rchief", "+", "Rhovec"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rsundeputy", " ", "=", " ", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}], 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}]}], "]"}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"asrpDeuty", " ", "=", " ", 
   RowBox[{
    FractionBox["PD", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}]}]], 
    RowBox[{"n3vec", ".", "Rsundeputy"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"const1", " ", "Rsundeputy"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"const2", " ", 
          RowBox[{"n3vec", ".", "Rsundeputy"}]}], "+", " ", "const3"}], ")"}],
        "n3vec"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"asrpChief", " ", "=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["PC", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Rsun", " ", "-", " ", "Rchief"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"Rsun", " ", "-", " ", "Rchief"}], ")"}]}]]}], " ", 
    FractionBox[
     RowBox[{"(", 
      RowBox[{"Rsun", " ", "-", " ", "Rchief"}], ")"}], 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Rsun", " ", "-", " ", "Rchief"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"Rsun", " ", "-", " ", "Rchief"}], ")"}]}], "]"}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Delagravity", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["muEarth", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Rdeputy", ".", "Rdeputy"}], "]"}]]}], "Rdeputy"}], "+", " ", 
    
    RowBox[{
     FractionBox["muEarth", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"Rchief", ".", "Rchief"}], "]"}]], 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoriolisEffect", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Cross", "[", 
      RowBox[{"OmegaLVLH", ",", "Rhovec"}], "]"}]}], " ", "-", " ", 
    RowBox[{"2", " ", 
     RowBox[{"Cross", "[", 
      RowBox[{"OmegadotLVLH", ",", "Rhodotvec"}], "]"}]}], " ", "-", " ", 
    RowBox[{"Cross", "[", 
     RowBox[{"OmegaLVLH", ",", 
      RowBox[{"Cross", "[", 
       RowBox[{"OmegaLVLH", ",", "Rhovec"}], "]"}]}], "]"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RelAcceleration", " ", "=", " ", 
    RowBox[{"Delagravity", " ", "+", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CBmatrix", ".", "asrpDeuty"}], " ", "-", " ", "asrpChief"}], 
      ")"}], " ", "+", " ", "CoriolisEffect"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xstate", " ", "=", " ", 
   RowBox[{"Join", "[", 
    RowBox[{"Qvec", ",", "OmegaVector", ",", "Rhovec", ",", "Rhodotvec"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Fd", "   ", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"OmegaMatrix", ".", "Qvec"}]}], ",", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Inverse", "[", "InertiaMatrix", "]"}], ".", "Omegatilde", 
        ".", "InertiaMatrix", ".", "OmegaVector"}]}], ",", "Rhodotvec", ",", 
      "RelAcceleration"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pCb1pQvec", " ", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"CBmatrix", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", "Qvec", "}"}]}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pCb2pQvec", " ", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"CBmatrix", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", "Qvec", "}"}]}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pCb3pQvec", " ", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"CBmatrix", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", 
      RowBox[{"{", "Qvec", "}"}]}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToMatlab", "[", 
   RowBox[{"pCb1pQvec", ",", "\"\<pCb1pQvec\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToMatlab", "[", 
   RowBox[{"pCb2pQvec", ",", "\"\<pCb2pQvec\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToMatlab", "[", 
    RowBox[{"pCb3pQvec", ",", "\"\<pCb3pQvec\>\""}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pDelAccgprho", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"Delagravity", ",", 
         RowBox[{"{", "Rhovec", "}"}]}], "]"}], "//", "FullSimplify"}], "//", 
      "MatrixForm"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{"pDelAccgprho", ",", "\"\<pDelAccgprho\>\""}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"pDelCoriolisgprhorhodot", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"CoriolisEffect", ",", 
        RowBox[{"{", 
         RowBox[{"Join", "[", 
          RowBox[{"Rhovec", ",", "Rhodotvec"}], "]"}], "}"}]}], "]"}], "//", 
      "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{
     "pDelCoriolisgprhorhodot", ",", "\"\<pDelCoriolisgprhorhodot\>\""}], 
     "]"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"PartialAngularVel", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"Inverse", "[", "InertiaMatrix", "]"}], ".", "Omegatilde", 
          ".", "InertiaMatrix", ".", "OmegaVector"}]}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Join", "[", 
          RowBox[{"SigmaVector", ",", "OmegaVector"}], "]"}], "}"}]}], "]"}], 
      "//", "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ToMatlab", "[", 
     RowBox[{"PartialAngularVel", ",", "\"\<PartialAngularVel\>\""}], "]"}]}],
    "*)"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PartialQdot", " ", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"OmegaMatrix", ".", "Qvec"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Join", "[", 
        RowBox[{"Qvec", ",", "OmegaVector"}], "]"}], "}"}]}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"PartialQdot", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{"PartialQdot", ",", "\"\<PartialQdot\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.80443526762157*^9, 3.804435367513208*^9}, {
   3.804435711768063*^9, 3.804435835207158*^9}, {3.804435875907009*^9, 
   3.804435901218388*^9}, {3.804435998433366*^9, 3.804436049302458*^9}, {
   3.804436435341043*^9, 3.804436464835253*^9}, {3.804436500101802*^9, 
   3.804436504285536*^9}, {3.804506097325946*^9, 3.804506097830912*^9}, {
   3.804506257932744*^9, 3.804506333397629*^9}, {3.804506662065723*^9, 
   3.804506713733913*^9}, {3.804507162543681*^9, 3.8045071753502083`*^9}, {
   3.804507219208268*^9, 3.804507285883576*^9}, 3.80450753261285*^9, {
   3.80450795351294*^9, 3.804508041150701*^9}, {3.804508087386804*^9, 
   3.8045082887780848`*^9}, {3.804508422129871*^9, 3.804508436072339*^9}, 
   3.8045085328758593`*^9, {3.8045086068362217`*^9, 3.804508659104211*^9}, {
   3.80450875267673*^9, 3.8045087986652403`*^9}, {3.804508883401223*^9, 
   3.804508964306608*^9}, 3.8045091856986628`*^9, {3.804538374599062*^9, 
   3.804538403135157*^9}, 3.804538471077682*^9, {3.804538769021845*^9, 
   3.80453879998664*^9}, 3.804539138302248*^9, {3.804539330094625*^9, 
   3.804539640723957*^9}, {3.804539811629938*^9, 3.804540025781108*^9}, {
   3.8045401107409277`*^9, 3.8045402182991*^9}, {3.804540249613669*^9, 
   3.8045403060824013`*^9}, {3.804540660809506*^9, 3.8045406615143013`*^9}, {
   3.804540812571495*^9, 3.8045408135163507`*^9}, 3.804545949708826*^9, {
   3.8045460171123657`*^9, 3.8045460831235847`*^9}, {3.804546196889607*^9, 
   3.804546224412876*^9}, {3.80454638304773*^9, 3.8045464734789867`*^9}, 
   3.8045466773235188`*^9, {3.8045469340232477`*^9, 3.804547045641464*^9}, {
   3.804548372141665*^9, 3.804548581958765*^9}, {3.804548714626302*^9, 
   3.804548783889023*^9}, {3.804548863937626*^9, 3.8045488924004183`*^9}, {
   3.804713589707571*^9, 3.804713608434429*^9}, {3.804713754054081*^9, 
   3.804713886175062*^9}, {3.804714012567358*^9, 3.804714249240694*^9}, 
   3.804714281157477*^9, {3.804714855329782*^9, 3.804714916197749*^9}, {
   3.80471533140588*^9, 3.804715343745554*^9}, {3.8047153745098877`*^9, 
   3.804715388282263*^9}, {3.80471542003823*^9, 3.804715435099244*^9}, {
   3.8047159621049147`*^9, 3.8047160263501368`*^9}, {3.8047161063287897`*^9, 
   3.804716108582142*^9}, {3.8047161834432383`*^9, 3.804716270182815*^9}},
 CellLabel->
  "In[411]:=",ExpressionUUID->"25980983-d7a8-45d8-a43d-0374db97dd14"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", 
       FractionBox["omg1", "2"]}], 
      RowBox[{"-", 
       FractionBox["omg2", "2"]}], 
      RowBox[{"-", 
       FractionBox["omg3", "2"]}], 
      RowBox[{"-", 
       FractionBox["q1", "2"]}], 
      RowBox[{"-", 
       FractionBox["q2", "2"]}], 
      RowBox[{"-", 
       FractionBox["q3", "2"]}]},
     {
      FractionBox["omg1", "2"], "0", 
      FractionBox["omg3", "2"], 
      RowBox[{"-", 
       FractionBox["omg2", "2"]}], 
      FractionBox["q0", "2"], 
      RowBox[{"-", 
       FractionBox["q3", "2"]}], 
      FractionBox["q2", "2"]},
     {
      FractionBox["omg2", "2"], 
      RowBox[{"-", 
       FractionBox["omg3", "2"]}], "0", 
      FractionBox["omg1", "2"], 
      FractionBox["q3", "2"], 
      FractionBox["q0", "2"], 
      RowBox[{"-", 
       FractionBox["q1", "2"]}]},
     {
      FractionBox["omg3", "2"], 
      FractionBox["omg2", "2"], 
      RowBox[{"-", 
       FractionBox["omg1", "2"]}], "0", 
      RowBox[{"-", 
       FractionBox["q2", "2"]}], 
      FractionBox["q1", "2"], 
      FractionBox["q0", "2"]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.804716257870101*^9, 3.8047162719223146`*^9}},
 CellLabel->
  "Out[447]//MatrixForm=",ExpressionUUID->"cfcf6695-bb2a-4f79-b960-\
e199887ed3f6"],

Cell[BoxData["\<\"PartialQdot=[0,(-1/2).*omg1,(-1/2).*omg2,(-1/2).*omg3,(-1/2)\
.*q1,(-1/2).*q2,( ...\\n  \
-1/2).*q3;(1/2).*omg1,0,(1/2).*omg3,(-1/2).*omg2,(1/2).*q0,(-1/2) ...\\n  \
.*q3,(1/2).*q2;(1/2).*omg2,(-1/2).*omg3,0,(1/2).*omg1,(1/2).*q3,( ...\\n  \
1/2).*q0,(-1/2).*q1;(1/2).*omg3,(1/2).*omg2,(-1/2).*omg1,0,(-1/2) ...\\n  \
.*q2,(1/2).*q1,(1/2).*q0];\\n\"\>"], "Output",
 CellChangeTimes->{{3.804716257870101*^9, 3.804716272223027*^9}},
 CellLabel->
  "Out[448]=",ExpressionUUID->"ea9fb6fd-541f-4ad1-920c-02a10b75232f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "ToMatlab`"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"asrpDeputy", " ", "=", " ", 
   RowBox[{
    FractionBox["PD", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}], ".", 
      RowBox[{"(", 
       RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}]}]], 
    RowBox[{"n3vec", ".", "Rsundeputy"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"const1", " ", "Rsundeputy"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"const2", " ", 
          RowBox[{"n3vec", ".", "Rsundeputy"}]}], "+", " ", "const3"}], ")"}],
        "n3vec"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", " ", "=", " ", 
   FractionBox["1", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a2", " ", "=", " ", 
    RowBox[{
     RowBox[{"n3vec", ".", "Rsundeputy"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"C1", " ", "Rsundeputy"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"C2", " ", 
           RowBox[{"n3vec", ".", "Rsundeputy"}]}], "+", " ", "C3"}], ")"}], 
        "n3vec"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"asrpDeputy", "//", "FullSimplify"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"a1", ",", "Rdeputy"}], "]"}], "//", "FullSimplify"}], "//", 
   "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"a2", ",", "Rsundeputy"}], "]"}], "//", "FullSimplify"}], "//", 
    "MatrixForm"}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rsundeputy", " ", "=", " ", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{"Rsun", " ", "-", " ", "Rdeputy"}], ")"}]}], ")"}], 
     RowBox[{"1", "/", "2"}]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"Rsundeputy", ",", "Rdeputy"}], "]"}], "//", "MatrixForm"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"BN", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"q0", "*", "q0"}], " ", "+", " ", 
         RowBox[{"q1", "*", "q1"}], " ", "-", " ", 
         RowBox[{"q2", "*", "q2"}], " ", "-", " ", 
         RowBox[{"q3", "*", "q3"}]}], ",", " ", 
        RowBox[{"2", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", "*", "q2"}], " ", "+", " ", 
           RowBox[{"q0", "*", "q3"}]}], ")"}]}], ",", "  ", 
        RowBox[{"2", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", "*", "q3"}], " ", "-", " ", 
           RowBox[{"q0", "*", "q2"}]}], ")"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", "       ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", "*", "q2"}], " ", "-", " ", 
           RowBox[{"q0", "*", "q3"}]}], ")"}]}], " ", ",", " ", 
        RowBox[{
         RowBox[{"q0", "*", "q0"}], " ", "-", " ", 
         RowBox[{"q1", "*", "q1"}], " ", "+", " ", 
         RowBox[{"q2", "*", "q2"}], " ", "-", " ", 
         RowBox[{"q3", "*", "q3"}]}], ",", "  ", 
        RowBox[{"2", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q2", "*", "q3"}], " ", "+", " ", 
           RowBox[{"q0", "*", "q1"}]}], ")"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", "        ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"2", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q1", "*", "q3"}], " ", "+", " ", 
           RowBox[{"q0", "*", "q2"}]}], ")"}]}], ",", "  ", 
        RowBox[{"2", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"q2", "*", "q3"}], " ", "-", " ", 
           RowBox[{"q0", "*", "q1"}]}], ")"}]}], ",", "  ", 
        RowBox[{
         RowBox[{"q0", "*", "q0"}], " ", "-", " ", 
         RowBox[{"q1", "*", "q1"}], " ", "-", " ", 
         RowBox[{"q2", "*", "q2"}], " ", "+", " ", 
         RowBox[{"q3", "*", "q3"}]}]}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n3vec", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q1", "*", "q3"}], " ", "+", " ", 
        RowBox[{"q0", "*", "q2"}]}], ")"}]}], ",", "  ", 
     RowBox[{"2", "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"q2", "*", "q3"}], " ", "-", " ", 
        RowBox[{"q0", "*", "q1"}]}], ")"}]}], ",", "  ", 
     RowBox[{
      RowBox[{"q0", "*", "q0"}], " ", "-", " ", 
      RowBox[{"q1", "*", "q1"}], " ", "-", " ", 
      RowBox[{"q2", "*", "q2"}], " ", "+", " ", 
      RowBox[{"q3", "*", "q3"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Qvec", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"q0", ",", "q1", ",", "q2", ",", "q3"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pN3vec1pQvec", " ", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"n3vec", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"{", "Qvec", "}"}]}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pN3vec2pQvec", " ", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"n3vec", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", "Qvec", "}"}]}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pN3vec3pQvec", " ", "=", " ", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"n3vec", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"{", "Qvec", "}"}]}], "]"}], "//", "FullSimplify"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"pN3vec1pQvec", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"pN3vec2pQvec", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"pN3vec3pQvec", "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{"pN3vec1pQvec", ",", "\"\<pN3vec1pQvec\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ToMatlab", "[", 
  RowBox[{"pN3vec2pQvec", ",", "\"\<pN3vec2pQvec\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToMatlab", "[", 
   RowBox[{"pN3vec3pQvec", ",", "\"\<pN3vec3pQvec\>\""}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"sigma", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"sig1", ",", "sig2", ",", "sig3"}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"sig", " ", "=", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["sig1", "2"], "+", 
        SuperscriptBox["sig2", "2"], "+", 
        SuperscriptBox["sig3", "2"]}], ")"}], 
      RowBox[{"1", "/", "2"}]]}], ";", "\[IndentingNewLine]", 
    RowBox[{"n3vec", " ", "=", " ", 
     RowBox[{
      FractionBox["1", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["sig", "2"]}], ")"}], "2"]], 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"8", "sig3", " ", "sig1"}], " ", "+", " ", 
         RowBox[{"4", " ", "sig2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["sig", "2"]}], ")"}]}]}], ",", 
        RowBox[{
         RowBox[{"8", "sig3", " ", "sig2"}], " ", "-", " ", 
         RowBox[{"4", " ", "sig1", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["sig", "2"]}], ")"}]}]}], ",", " ", 
        RowBox[{
         RowBox[{"4", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SuperscriptBox["sig1", "2"]}], "-", 
            SuperscriptBox["sig2", "2"], "+", 
            SuperscriptBox["sig3", "2"]}], ")"}]}], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["sig", "2"]}], ")"}], "2"]}]}], "}"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"pNvec1pSigma", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"n3vec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"{", "sigma", "}"}]}], "]"}], "//", "FullSimplify"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"pNvec2pSigma", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"n3vec", "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"{", "sigma", "}"}]}], "]"}], "//", "FullSimplify"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"pNvec3pSigma", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"n3vec", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", 
        RowBox[{"{", "sigma", "}"}]}], "]"}], "//", "FullSimplify"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ToMatlab", "[", 
      RowBox[{"pNvec1pSigma", ",", "\"\<pNvec1pSigma\>\""}], "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ToMatlab", "[", 
      RowBox[{"pNvec2pSigma", ",", "\"\<pNvec2pSigma\>\""}], "]"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ToMatlab", "[", 
      RowBox[{"pNvec3pSigma", ",", "\"\<pNvec3pSigma\>\""}], "]"}]}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.804509189258657*^9, 3.804509258830399*^9}, {
   3.8045098640587893`*^9, 3.804509882159006*^9}, {3.804510023993306*^9, 
   3.804510050293325*^9}, {3.804510242229782*^9, 3.804510263874269*^9}, {
   3.804511044119351*^9, 3.804511046199168*^9}, {3.804511949047752*^9, 
   3.804512015473257*^9}, {3.8045121163153667`*^9, 3.804512127710362*^9}, {
   3.8045121646295557`*^9, 3.804512202002511*^9}, {3.804512713069273*^9, 
   3.804512713682823*^9}, {3.804523921095422*^9, 3.8045239479330063`*^9}, {
   3.804523980568014*^9, 3.804524083926444*^9}, {3.804524264049717*^9, 
   3.8045242871423388`*^9}, {3.804524346417604*^9, 3.804524390350595*^9}, {
   3.804524465354641*^9, 3.804524493518059*^9}, {3.804524551831789*^9, 
   3.804524580021735*^9}, 3.804524611267522*^9, {3.8045375407982397`*^9, 
   3.8045375612701674`*^9}, {3.8045376289327087`*^9, 3.804537673512869*^9}, {
   3.804537712069994*^9, 3.8045377274584084`*^9}, {3.804537885542592*^9, 
   3.804537946284359*^9}, {3.804537993603895*^9, 3.804538106093453*^9}, {
   3.804540357834908*^9, 3.804540398607045*^9}, {3.8045459909836483`*^9, 
   3.8045459941820097`*^9}, {3.80471215119394*^9, 3.804712162000572*^9}, {
   3.80471223954224*^9, 3.804712396373228*^9}, {3.804712429352034*^9, 
   3.804712437569113*^9}, {3.804712580525105*^9, 3.804712587207521*^9}, {
   3.804712795295994*^9, 3.804712819339067*^9}, {3.8047130073250837`*^9, 
   3.804713068324278*^9}, {3.804713227069976*^9, 3.804713234341421*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"601c0d09-e23a-4333-b67b-03c903855f3d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"2", " ", "q2"}]},
      {
       RowBox[{"2", " ", "q3"}]},
      {
       RowBox[{"2", " ", "q0"}]},
      {
       RowBox[{"2", " ", "q1"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.804712441083386*^9, 3.804712589739045*^9, 
  3.804712847938519*^9, 3.8047130134987087`*^9, 3.804713091310727*^9, 
  3.804713236353022*^9},
 CellLabel->
  "Out[162]//MatrixForm=",ExpressionUUID->"e6963113-22b2-422d-b0da-\
24b9893f5212"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"-", "2"}], " ", "q1"}]},
      {
       RowBox[{
        RowBox[{"-", "2"}], " ", "q0"}]},
      {
       RowBox[{"2", " ", "q3"}]},
      {
       RowBox[{"2", " ", "q2"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.804712441083386*^9, 3.804712589739045*^9, 
  3.804712847938519*^9, 3.8047130134987087`*^9, 3.804713091310727*^9, 
  3.804713236692916*^9},
 CellLabel->
  "Out[163]//MatrixForm=",ExpressionUUID->"7d9c0910-10a5-42f7-bbbb-\
d1eb35678e6c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"2", " ", "q0"}]},
      {
       RowBox[{
        RowBox[{"-", "2"}], " ", "q1"}]},
      {
       RowBox[{
        RowBox[{"-", "2"}], " ", "q2"}]},
      {
       RowBox[{"2", " ", "q3"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.804712441083386*^9, 3.804712589739045*^9, 
  3.804712847938519*^9, 3.8047130134987087`*^9, 3.804713091310727*^9, 
  3.804713236793762*^9},
 CellLabel->
  "Out[164]//MatrixForm=",ExpressionUUID->"b7c16931-81f6-4ead-b4eb-\
643992d41bea"],

Cell[BoxData["\<\"pN3vec1pQvec=[2.*q2,2.*q3,2.*q0,2.*q1];\\n\"\>"], "Output",
 CellChangeTimes->{3.804712441083386*^9, 3.804712589739045*^9, 
  3.804712847938519*^9, 3.8047130134987087`*^9, 3.804713091310727*^9, 
  3.804713236992087*^9},
 CellLabel->
  "Out[165]=",ExpressionUUID->"eede68a3-dd69-46c1-8e15-0cdc51e66a3e"],

Cell[BoxData["\<\"pN3vec2pQvec=[(-2).*q1,(-2).*q0,2.*q3,2.*q2];\\n\"\>"], \
"Output",
 CellChangeTimes->{3.804712441083386*^9, 3.804712589739045*^9, 
  3.804712847938519*^9, 3.8047130134987087`*^9, 3.804713091310727*^9, 
  3.8047132371380053`*^9},
 CellLabel->
  "Out[166]=",ExpressionUUID->"1826bc12-d1ef-4a29-9968-d7a5a43a5f14"],

Cell[BoxData["\<\"pN3vec3pQvec=[2.*q0,(-2).*q1,(-2).*q2,2.*q3];\\n\"\>"], \
"Output",
 CellChangeTimes->{3.804712441083386*^9, 3.804712589739045*^9, 
  3.804712847938519*^9, 3.8047130134987087`*^9, 3.804713091310727*^9, 
  3.804713237229*^9},
 CellLabel->
  "Out[167]=",ExpressionUUID->"e3110989-dd3a-477b-a73e-0e6a61a3d7d3"]
}, Open  ]]
},
WindowSize->{1012, 893},
WindowMargins->{{Automatic, -1919}, {Automatic, 142}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"SolarizedDarkStylesheet.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 5848, 122, 400, "Input",ExpressionUUID->"53b5a660-d093-4e31-ad2e-7e17080d0ab1"],
Cell[6409, 144, 10502, 268, 667, "Input",ExpressionUUID->"e11112d3-734d-44da-b4da-61bfdaf7b79d"],
Cell[16914, 414, 10357, 279, 615, "Input",ExpressionUUID->"74b649d0-6b7c-4788-81b8-876067159050"],
Cell[CellGroupData[{
Cell[27296, 697, 29080, 738, 1920, "Input",ExpressionUUID->"771bbf93-0f50-4b24-9ac9-44f18855875d"],
Cell[56379, 1437, 20865, 532, 203, "Output",ExpressionUUID->"b570fe40-cb08-4863-b73a-338d33fbd8ac"]
}, Open  ]],
Cell[77259, 1972, 2326, 67, 216, "Input",ExpressionUUID->"954eb9c5-d2c3-4d77-b646-1fb8171741c7"],
Cell[79588, 2041, 9350, 273, 834, "Input",ExpressionUUID->"d4846d1e-c957-4798-b4da-26b9024c1d65"],
Cell[88941, 2316, 9014, 261, 898, "Input",ExpressionUUID->"b4fa0279-e76c-4f92-9046-d463cfcc64a6"],
Cell[97958, 2579, 10593, 289, 1338, "Input",ExpressionUUID->"99270115-10c5-44b7-a0fa-10355b52ae8e"],
Cell[108554, 2870, 6266, 192, 992, "Input",ExpressionUUID->"8cbed590-ebce-4d07-9e11-b2717ee027d7"],
Cell[114823, 3064, 3649, 89, 333, "Input",ExpressionUUID->"aa20b7ef-767f-4919-85df-0b1e82c124f5"],
Cell[118475, 3155, 3324, 96, 491, "Input",ExpressionUUID->"c3dd048d-adff-4caa-baad-d710f529a32c"],
Cell[CellGroupData[{
Cell[121824, 3255, 18550, 504, 1866, "Input",ExpressionUUID->"25980983-d7a8-45d8-a43d-0374db97dd14"],
Cell[140377, 3761, 1705, 57, 161, "Output",ExpressionUUID->"cfcf6695-bb2a-4f79-b960-e199887ed3f6"],
Cell[142085, 3820, 531, 8, 174, "Output",ExpressionUUID->"ea9fb6fd-541f-4ad1-920c-02a10b75232f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142653, 3833, 11796, 318, 1135, "Input",ExpressionUUID->"601c0d09-e23a-4333-b67b-03c903855f3d"],
Cell[154452, 4153, 921, 29, 121, "Output",ExpressionUUID->"e6963113-22b2-422d-b0da-24b9893f5212"],
Cell[155376, 4184, 969, 31, 121, "Output",ExpressionUUID->"7d9c0910-10a5-42f7-bbbb-d1eb35678e6c"],
Cell[156348, 4217, 969, 31, 121, "Output",ExpressionUUID->"b7c16931-81f6-4ead-b4eb-643992d41bea"],
Cell[157320, 4250, 320, 5, 86, "Output",ExpressionUUID->"eede68a3-dd69-46c1-8e15-0cdc51e66a3e"],
Cell[157643, 4257, 330, 6, 86, "Output",ExpressionUUID->"1826bc12-d1ef-4a29-9968-d7a5a43a5f14"],
Cell[157976, 4265, 325, 6, 86, "Output",ExpressionUUID->"e3110989-dd3a-477b-a73e-0e6a61a3d7d3"]
}, Open  ]]
}
]
*)

